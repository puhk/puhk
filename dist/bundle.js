!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["nojball-game"]=e():t["nojball-game"]=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="/dist/",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Events=e.Background=e.Renderer=e.GameCreator=void 0;var o=n(2),u=i(o),a=n(114),s=i(a),c=n(110),f=i(c),l=n(116),h=r(l);e.GameCreator=u.default,e.Renderer=s.default,e.Background=f.default,e.Events=h},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),u=n(126),a=r(u),s=n(140),c=r(s),f={host:function(t){var e=new o.default(t),n=new a.default(e);return n.peer.on("open",function(){e.createInitialState(),e.init()}),e},join:function(t,e){var n=new o.default(e),r=new c.default(n);return r.connectTo(t),n}};e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(62),l=r(f),h=n(63),p=r(h),d=n(64),v=n(66),y=r(v),_=n(108),g=r(_),m=n(109),b=r(m),w=n(114),k=r(w),x=n(124),S=r(x),M=n(115),E=r(M),A=n(116),O=n(73),T=r(O),C=n(111),P=(r(C),n(119)),I=r(P),j=n(113),B=(r(j),n(125)),D=r(B),L=function(){function t(e){var n=this;(0,a.default)(this,t),this.inited=!1,this.myId=-1,this.engine=new y.default(this),this.simulator=new S.default(this.engine),this.renderer=e,this.eventAggregator=new d.EventAggregator,this.keyboard=new g.default(function(t,e){var r=new A.Keypress(n.myId,{key:t,state:e,clientId:n.myId});n.addEvent(r)})}return(0,c.default)(t,[{key:"init",value:function(){!this.inited&&this.network&&(this.setupLoop(),this.startLoop(),this.inited=!0)}},{key:"destroy",value:function(){this.inited&&(this.stopLoop(),this.inited=!1)}},{key:"initRenderer",value:function(){this.renderer instanceof k.default&&this.renderer.init()}},{key:"addEvent",value:function(t,e){this.simulator.addEvent(t),e&&this.network.sendMsg(t.toMessage())}},{key:"start",value:function(){this.addEvent(new A.StartGame(this.myId))}},{key:"stop",value:function(t){this.addEvent(new A.StopGame(this.myId))}},{key:"createInitialState",value:function(){var t=new b.default(D.default),e=E.default.createFromStadium(t);this.simulator.states.unshift(e);var n=this.createPlayer(this.myId,"noj",t.teams[0]);e.addPlayers(n)}},{key:"createPlayer",value:function(t,e,n){return new I.default(t,e,n.name)}},{key:"createPlayerDisc",value:function(t){var e=this.simulator.currentState.stadium,n=e.getTeam(t.team);if(null!==t.team&&n){var r=new T.default(new p.default(0,0),e.playerPhysics.radius,{color:n.color,damping:e.playerPhysics.damping,invMass:e.playerPhysics.invMass});return r.kickStrength=e.playerPhysics.kickStrength,r.isMe=t.clientId==this.myId,r}}},{key:"createPlayerDiscs",value:function(t){var e=[],n=!0,r=!1,i=void 0;try{for(var u,a=(0,o.default)(t.players);!(n=(u=a.next()).done);n=!0){var s=u.value,c=this.createPlayerDisc(s);if(!c)return;s.discId=c.id,s.clientId==this.myId&&(c.isMe=!0),e.push(c)}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}t.addDiscs(e)}},{key:"movePlayerToTeam",value:function(t,e){this.addEvent(new A.ChangeTeam(this.myId,{clientId:t,team:e}))}},{key:"kickOffState",value:function(t){t.matchState=E.default.STATE_KICKOFF,this.setKickOffPositions(t),t.discs.filter(function(t){return t.isBall}).forEach(function(t){t.position=new p.default(0,0),t.velocity=new p.default(0,0)})}},{key:"setKickOffPositions",value:function(t){t.players.forEach(function(e){var n=t.getPlayerDisc(e),r=t.stadium.getTeam(e.team);n&&r&&(n.position=p.default.fromArray(r.kickOffPos),n.velocity=new p.default(0,0))})}},{key:"goalScored",value:function(t,e){var n=e.stadium.getTeam(t.teamScored);e.matchState==E.default.STATE_INPLAY&&n&&(++e.scores[n.name],e.matchState=E.default.STATE_GOALSCORED,e.matchStateTimer=150)}},{key:"scoresEqual",value:function(t){var e=t.stadium.teams.map(function(e){return t.scores[e.name]});return e.every(function(t){return t==e[0]})}},{key:"update",value:function(t){switch(t.matchState){case E.default.STATE_KICKOFF:t.discs.filter(function(t){return t.isBall}).forEach(function(e){(e.velocity.x>0||e.velocity.y>0)&&(t.matchState=E.default.STATE_INPLAY)});break;case E.default.STATE_INPLAY:t.timer+=1/60,t.timer>=60*t.timeLimit&&!this.scoresEqual(t)&&(t.matchState=E.default.STATE_ENDGAME,t.matchStateTimer=300);break;case E.default.STATE_GOALSCORED:if(--t.matchStateTimer,t.matchStateTimer>0)return;var e=!0,n=!1,r=void 0;try{for(var i,u=(0,o.default)(t.stadium.teams);!(e=(i=u.next()).done);e=!0){var a=i.value,s=t.scores[a.name];if(s>=t.scoreLimit)return t.matchState=E.default.STATE_ENDGAME,void(t.matchStateTimer=300)}}catch(t){n=!0,r=t}finally{try{!e&&u.return&&u.return()}finally{if(n)throw r}}t.matchState=E.default.STATE_KICKOFF,this.kickOffState(t);break;case E.default.STATE_ENDGAME:--t.matchStateTimer,0==t.matchStateTimer&&this.stop(t)}}},{key:"setupLoop",value:function(){var t=this;l.default.setUpdate(function(){t.simulator.advance()}),l.default.setDraw(function(){t.renderer&&t.simulator.currentState.playing&&t.renderer.draw(t.simulator.currentState)})}},{key:"startLoop",value:function(){l.default.start()}},{key:"stopLoop",value:function(){l.default.stop()}}]),t}();e.default=L},function(t,e,n){t.exports={default:n(5),__esModule:!0}},function(t,e,n){n(6),n(52),t.exports=n(54)},function(t,e,n){n(7);for(var r=n(18),i=n(22),o=n(10),u=n(49)("toStringTag"),a=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],s=0;s<5;s++){var c=a[s],f=r[c],l=f&&f.prototype;l&&!l[u]&&i(l,u,c),o[c]=o.Array}},function(t,e,n){"use strict";var r=n(8),i=n(9),o=n(10),u=n(11);t.exports=n(15)(Array,"Array",function(t,e){this._t=u(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,n):"values"==e?i(0,t[n]):i(0,[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e){t.exports={}},function(t,e,n){var r=n(12),i=n(14);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(13);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){"use strict";var r=n(16),i=n(17),o=n(32),u=n(22),a=n(33),s=n(10),c=n(34),f=n(48),l=n(50),h=n(49)("iterator"),p=!([].keys&&"next"in[].keys()),d="@@iterator",v="keys",y="values",_=function(){return this};t.exports=function(t,e,n,g,m,b,w){c(n,e,g);var k,x,S,M=function(t){if(!p&&t in T)return T[t];switch(t){case v:return function(){return new n(this,t)};case y:return function(){return new n(this,t)}}return function(){return new n(this,t)}},E=e+" Iterator",A=m==y,O=!1,T=t.prototype,C=T[h]||T[d]||m&&T[m],P=C||M(m),I=m?A?M("entries"):P:void 0,j="Array"==e?T.entries||C:C;if(j&&(S=l(j.call(new t)),S!==Object.prototype&&(f(S,E,!0),r||a(S,h)||u(S,h,_))),A&&C&&C.name!==y&&(O=!0,P=function(){return C.call(this)}),r&&!w||!p&&!O&&T[h]||u(T,h,P),s[e]=P,s[E]=_,m)if(k={values:A?P:M(y),keys:b?P:M(v),entries:I},w)for(x in k)x in T||o(T,x,k[x]);else i(i.P+i.F*(p||O),e,k);return k}},function(t,e){t.exports=!0},function(t,e,n){var r=n(18),i=n(19),o=n(20),u=n(22),a="prototype",s=function(t,e,n){var c,f,l,h=t&s.F,p=t&s.G,d=t&s.S,v=t&s.P,y=t&s.B,_=t&s.W,g=p?i:i[e]||(i[e]={}),m=g[a],b=p?r:d?r[e]:(r[e]||{})[a];p&&(n=e);for(c in n)f=!h&&b&&void 0!==b[c],f&&c in g||(l=f?b[c]:n[c],g[c]=p&&"function"!=typeof b[c]?n[c]:y&&f?o(l,r):_&&b[c]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e[a]=t[a],e}(l):v&&"function"==typeof l?o(Function.call,l):l,v&&((g.virtual||(g.virtual={}))[c]=l,t&s.R&&m&&!m[c]&&u(m,c,l)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(21);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(23),i=n(31);t.exports=n(27)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(24),i=n(26),o=n(30),u=Object.defineProperty;e.f=n(27)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return u(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(25);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){t.exports=!n(27)&&!n(28)(function(){return 7!=Object.defineProperty(n(29)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){t.exports=!n(28)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(25),i=n(18).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(25);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){t.exports=n(22)},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var r=n(35),i=n(31),o=n(48),u={};n(22)(u,n(49)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(u,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(24),i=n(36),o=n(46),u=n(43)("IE_PROTO"),a=function(){},s="prototype",c=function(){var t,e=n(29)("iframe"),r=o.length,i="<",u=">";for(e.style.display="none",n(47).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+u+"document.F=Object"+i+"/script"+u),t.close(),c=t.F;r--;)delete c[s][o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(a[s]=r(t),n=new a,a[s]=null,n[u]=t):n=c(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(23),i=n(24),o=n(37);t.exports=n(27)?Object.defineProperties:function(t,e){i(t);for(var n,u=o(e),a=u.length,s=0;a>s;)r.f(t,n=u[s++],e[n]);return t}},function(t,e,n){var r=n(38),i=n(46);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(33),i=n(11),o=n(39)(!1),u=n(43)("IE_PROTO");t.exports=function(t,e){var n,a=i(t),s=0,c=[];for(n in a)n!=u&&r(a,n)&&c.push(n);for(;e.length>s;)r(a,n=e[s++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(11),i=n(40),o=n(42);t.exports=function(t){return function(e,n,u){var a,s=r(e),c=i(s.length),f=o(u,c);if(t&&n!=n){for(;c>f;)if(a=s[f++],a!=a)return!0}else for(;c>f;f++)if((t||f in s)&&s[f]===n)return t||f||0;return!t&&-1}}},function(t,e,n){var r=n(41),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(41),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(44)("keys"),i=n(45);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){var r=n(18),i="__core-js_shared__",o=r[i]||(r[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){t.exports=n(18).document&&document.documentElement},function(t,e,n){var r=n(23).f,i=n(33),o=n(49)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(44)("wks"),i=n(45),o=n(18).Symbol,u="function"==typeof o,a=t.exports=function(t){return r[t]||(r[t]=u&&o[t]||(u?o:i)("Symbol."+t))};a.store=r},function(t,e,n){var r=n(33),i=n(51),o=n(43)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,e,n){var r=n(14);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";var r=n(53)(!0);n(15)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){var r=n(41),i=n(14);t.exports=function(t){return function(e,n){var o,u,a=String(i(e)),s=r(n),c=a.length;return s<0||s>=c?t?"":void 0:(o=a.charCodeAt(s),o<55296||o>56319||s+1===c||(u=a.charCodeAt(s+1))<56320||u>57343?t?a.charAt(s):o:t?a.slice(s,s+2):(o-55296<<10)+(u-56320)+65536)}}},function(t,e,n){var r=n(24),i=n(55);t.exports=n(19).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},function(t,e,n){var r=n(56),i=n(49)("iterator"),o=n(10);t.exports=n(19).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(13),i=n(49)("toStringTag"),o="Arguments"==r(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=u(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(59),o=r(i);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},function(t,e,n){t.exports={default:n(60),__esModule:!0}},function(t,e,n){n(61);var r=n(19).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(17);r(r.S+r.F*!n(27),"Object",{defineProperty:n(23).f})},function(t,e,n){var r,i;/**
	 * mainloop.js 1.0.3-20160320
	 *
	 * @author Isaac Sukin (http://www.isaacsukin.com/)
	 * @license MIT
	 */
!function(o){function u(t){if(a=b(u),!(f+v>t)){for(c+=t-f,f=t,x(t,c),t>h+1e3&&(l=.25*p+.75*l,h=t,p=0),p++,d=0;c>=s;)if(S(s),c-=s,++d>=240){g=!0;break}M(c/s),E(l,g),g=!1}}var a,s=1e3/60,c=0,f=0,l=60,h=0,p=0,d=0,v=0,y=!1,_=!1,g=!1,m="object"==typeof window?window:o,b=m.requestAnimationFrame||function(){var t,e,n=Date.now();return function(r){return t=Date.now(),e=Math.max(0,s-(t-n)),n=t+e,setTimeout(function(){r(t+e)},e)}}(),w=m.cancelAnimationFrame||clearTimeout,k=function(){},x=k,S=k,M=k,E=k;o.MainLoop={getSimulationTimestep:function(){return s},setSimulationTimestep:function(t){return s=t,this},getFPS:function(){return l},getMaxAllowedFPS:function(){return 1e3/v},setMaxAllowedFPS:function(t){return"undefined"==typeof t&&(t=1/0),0===t?this.stop():v=1e3/t,this},resetFrameDelta:function(){var t=c;return c=0,t},setBegin:function(t){return x=t||x,this},setUpdate:function(t){return S=t||S,this},setDraw:function(t){return M=t||M,this},setEnd:function(t){return E=t||E,this},start:function(){return _||(_=!0,a=b(function(t){M(1),y=!0,f=t,h=t,p=0,a=b(u)})),this},stop:function(){return y=!1,_=!1,w(a),this},isRunning:function(){return y}},r=o.MainLoop,i="function"==typeof r?r.call(e,n,e,t):r,!(void 0!==i&&(t.exports=i))}(this)},function(t,e){function n(t,e){return this instanceof n?(this.x=t||0,void(this.y=e||0)):new n(t,e)}function r(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function i(t){return t*u}function o(t){return t/u}e=t.exports=n,n.fromArray=function(t){return new n(t[0]||0,t[1]||0)},n.fromObject=function(t){return new n(t.x||0,t.y||0)},n.prototype.addX=function(t){return this.x+=t.x,this},n.prototype.addY=function(t){return this.y+=t.y,this},n.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},n.prototype.addScalarX=function(t){return this.x+=t,this},n.prototype.addScalarY=function(t){return this.y+=t,this},n.prototype.subtractX=function(t){return this.x-=t.x,this},n.prototype.subtractY=function(t){return this.y-=t.y,this},n.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.subtractScalar=function(t){return this.x-=t,this.y-=t,this},n.prototype.subtractScalarX=function(t){return this.x-=t,this},n.prototype.subtractScalarY=function(t){return this.y-=t,this},n.prototype.divideX=function(t){return this.x/=t.x,this},n.prototype.divideY=function(t){return this.y/=t.y,this},n.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},n.prototype.divideScalar=function(t){return 0!==t?(this.x/=t,this.y/=t):(this.x=0,this.y=0),this},n.prototype.divideScalarX=function(t){return 0!==t?this.x/=t:this.x=0,this},n.prototype.divideScalarY=function(t){return 0!==t?this.y/=t:this.y=0,this},n.prototype.invertX=function(){return this.x*=-1,this},n.prototype.invertY=function(){return this.y*=-1,this},n.prototype.invert=function(){return this.invertX(),this.invertY(),this},n.prototype.multiplyX=function(t){return this.x*=t.x,this},n.prototype.multiplyY=function(t){return this.y*=t.y,this},n.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},n.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},n.prototype.multiplyScalarX=function(t){return this.x*=t,this},n.prototype.multiplyScalarY=function(t){return this.y*=t,this},n.prototype.normalize=function(){var t=this.length();return 0===t?(this.x=1,this.y=0):this.divide(n(t,t)),this},n.prototype.norm=n.prototype.normalize,n.prototype.limit=function(t,e){return Math.abs(this.x)>t&&(this.x*=e),Math.abs(this.y)>t&&(this.y*=e),this},n.prototype.randomize=function(t,e){return this.randomizeX(t,e),this.randomizeY(t,e),this},n.prototype.randomizeX=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x);return this.x=r(n,i),this},n.prototype.randomizeY=function(t,e){var n=Math.min(t.y,e.y),i=Math.max(t.y,e.y);return this.y=r(n,i),this},n.prototype.randomizeAny=function(t,e){return Math.round(Math.random())?this.randomizeX(t,e):this.randomizeY(t,e),this},n.prototype.unfloat=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},n.prototype.toFixed=function(t){return"undefined"==typeof t&&(t=8),this.x=this.x.toFixed(t),this.y=this.y.toFixed(t),this},n.prototype.mixX=function(t,e){return"undefined"==typeof e&&(e=.5),this.x=(1-e)*this.x+e*t.x,this},n.prototype.mixY=function(t,e){return"undefined"==typeof e&&(e=.5),this.y=(1-e)*this.y+e*t.y,this},n.prototype.mix=function(t,e){return this.mixX(t,e),this.mixY(t,e),this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.copyX=function(t){return this.x=t.x,this},n.prototype.copyY=function(t){return this.y=t.y,this},n.prototype.copy=function(t){return this.copyX(t),this.copyY(t),this},n.prototype.zero=function(){return this.x=this.y=0,this},n.prototype.dot=function(t){return this.x*t.x+this.y*t.y},n.prototype.cross=function(t){return this.x*t.y-this.y*t.x},n.prototype.projectOnto=function(t){var e=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=e*t.x,this.y=e*t.y,this},n.prototype.horizontalAngle=function(){return Math.atan2(this.y,this.x)},n.prototype.horizontalAngleDeg=function(){return i(this.horizontalAngle())},n.prototype.verticalAngle=function(){return Math.atan2(this.x,this.y)},n.prototype.verticalAngleDeg=function(){return i(this.verticalAngle())},n.prototype.angle=n.prototype.horizontalAngle,n.prototype.angleDeg=n.prototype.horizontalAngleDeg,n.prototype.direction=n.prototype.horizontalAngle,n.prototype.rotate=function(t){var e=this.x*Math.cos(t)-this.y*Math.sin(t),n=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=e,this.y=n,this},n.prototype.rotateDeg=function(t){return t=o(t),this.rotate(t)},n.prototype.rotateTo=function(t){return this.rotate(t-this.angle())},n.prototype.rotateToDeg=function(t){return t=o(t),this.rotateTo(t)},n.prototype.rotateBy=function(t){var e=this.angle()+t;return this.rotate(e)},n.prototype.rotateByDeg=function(t){return t=o(t),this.rotateBy(t)},n.prototype.distanceX=function(t){return this.x-t.x},n.prototype.absDistanceX=function(t){return Math.abs(this.distanceX(t))},n.prototype.distanceY=function(t){return this.y-t.y},n.prototype.absDistanceY=function(t){return Math.abs(this.distanceY(t))},n.prototype.distance=function(t){return Math.sqrt(this.distanceSq(t))},n.prototype.distanceSq=function(t){var e=this.distanceX(t),n=this.distanceY(t);return e*e+n*n},n.prototype.length=function(){return Math.sqrt(this.lengthSq())},n.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},n.prototype.magnitude=n.prototype.length,n.prototype.isZero=function(){return 0===this.x&&0===this.y},n.prototype.isEqualTo=function(t){return this.x===t.x&&this.y===t.y},n.prototype.toString=function(){return"x:"+this.x+", y:"+this.y},n.prototype.toArray=function(){return[this.x,this.y]},n.prototype.toObject=function(){return{x:this.x,y:this.y}};var u=180/Math.PI},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t,e,n){try{t(e,n)}catch(t){f.error(t)}}function o(t,e){try{t.handle(e)}catch(t){f.error(t)}}function u(t){var e=new h;return t.subscribeOnce=function(t,n){return e.subscribeOnce(t,n)},t.subscribe=function(t,n){return e.subscribe(t,n)},t.publish=function(t,n){e.publish(t,n)},e}function a(t){t.instance(h,u(t.aurelia))}Object.defineProperty(e,"__esModule",{value:!0}),e.EventAggregator=void 0,e.includeEventsIn=u,e.configure=a;var s=n(65),c=r(s),f=c.getLogger("event-aggregator"),l=function(){function t(t,e){this.messageType=t,this.callback=e}return t.prototype.handle=function(t){t instanceof this.messageType&&this.callback.call(null,t)},t}(),h=e.EventAggregator=function(){function t(){this.eventLookup={},this.messageHandlers=[]}return t.prototype.publish=function(t,e){var n=void 0,r=void 0;if(!t)throw new Error("Event was invalid.");if("string"==typeof t){if(n=this.eventLookup[t])for(n=n.slice(),r=n.length;r--;)i(n[r],e,t)}else for(n=this.messageHandlers.slice(),r=n.length;r--;)o(n[r],t)},t.prototype.subscribe=function(t,e){var n=void 0,r=void 0;if(!t)throw new Error("Event channel/type was invalid.");return"string"==typeof t?(n=e,r=this.eventLookup[t]||(this.eventLookup[t]=[])):(n=new l(t,e),r=this.messageHandlers),r.push(n),{dispose:function(){var t=r.indexOf(n);t!==-1&&r.splice(t,1)}}},t.prototype.subscribeOnce=function(t,e){var n=this.subscribe(t,function(t,r){return n.dispose(),e(t,r)});return n},t}()},function(t,e){"use strict";function n(t,e,n){var r=v.length,i=void 0;for(n=y.call(n),n.unshift(t);r--;)i=v[r],i[e].apply(i,n)}function r(){this.level<4||n(this,"debug",arguments)}function i(){this.level<3||n(this,"info",arguments)}function o(){this.level<2||n(this,"warn",arguments)}function u(){this.level<1||n(this,"error",arguments)}function a(t){t.debug=r,t.info=i,t.warn=o,t.error=u}function s(t){var e=new m(t,_);return e.setLevel(g),v.length&&a(e),e}function c(t){return d[t]||(d[t]=s(t))}function f(t){if(v.push(t),1===v.length)for(var e in d)a(d[e])}function l(t){g=t;for(var e in d)d[e].setLevel(t)}function h(){return g}Object.defineProperty(e,"__esModule",{value:!0}),e.getLogger=c,e.addAppender=f,e.setLevel=l,e.getLevel=h;var p=e.logLevel={none:0,error:1,warn:2,info:3,debug:4},d={},v=[],y=Array.prototype.slice,_={},g=p.none,m=e.Logger=function(){function t(t,e){if(this.level=p.none,e!==_)throw new Error('Cannot instantiate "Logger". Use "getLogger" instead.');this.id=t}return t.prototype.debug=function(t){},t.prototype.info=function(t){},t.prototype.warn=function(t){},t.prototype.error=function(t){},t.prototype.setLevel=function(t){this.level=t},t}()},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(67),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(71),l=r(f),h=n(63),p=r(h),d=n(73),v=r(d),y=function(){function t(e){(0,a.default)(this,t),this.prevBallPositions={},this.game=e}return(0,c.default)(t,[{key:"run",value:function(t,e){this.state=t,this.applyEvents(e),this.update()}},{key:"applyEvents",value:function(t){var e=this;t.forEach(function(t){return t.apply(e.state,e.game)})}},{key:"update",value:function(){var t=this,e=this.state.stadium;this.state.discs.forEach(function(n,r){var i=l.default.find(t.state.players,{discId:n.id});if(i){n.kicking=i.keys.kick;var o=n.kicking?e.playerPhysics.kickingAcceleration:e.playerPhysics.acceleration,u=new p.default(0,0);i.keys.left&&(u.x-=1),i.keys.right&&(u.x+=1),i.keys.up&&(u.y-=1),i.keys.down&&(u.y+=1),0==u.x&&0==u.y||n.velocity.add(u.normalize().multiplyScalar(o))}n.position.add(n.velocity),n.velocity.multiplyScalar(n.damping)}),this.state.discs.sort(function(t,e){return t.isBall?1:-1}),this.state.discs.forEach(function(e,n){t.state.discs.forEach(function(r,i){r==e||n>=i||t.handleCircleCollision(e,r)}),t.state.stadium.segments.forEach(function(n){l.default.find(t.state.players,{discId:e.id})||t.handleSegmentCollision(e,n)}),e.isBall&&(t.state.stadium.goals.forEach(function(n){t.checkGoal(e,n)&&t.game.goalScored(n,t.state)}),t.prevBallPositions[e.id]=e.position.clone())}),this.game.update(this.state)}},{key:"handleCircleCollision",value:function(t,e){var n=t.position.distanceSq(e.position);if(e.isBall&&t.position.distance(e.position)<=t.radius+e.radius+4){var r=l.default.find(this.state.players,{discId:t.id});r&&r.keys.kick&&(this.kick(t,e),r.keys.kick=!1,t.kicking=!1)}n<=Math.pow(t.radius+e.radius,2)&&this.collideCircles(t,e)}},{key:"collideCircles",value:function(t,e){var n=t.position.clone().subtract(e.position),r=n.clone().normalize(),i=(t.mass+e.mass,t.invMass+e.invMass),o=t.radius+e.radius-n.length(),u=o*(t.invMass/i);t.position.add(r.clone().multiplyScalar(u)),e.position.subtract(r.clone().multiplyScalar(o-u));var a=t.velocity.clone().subtract(e.velocity),s=r.dot(a);if(s<0){var c=t.bounce*e.bounce,f=r.clone().multiplyScalar(s*(c+1)),l=f.clone().multiplyScalar(t.invMass/i),h=f.clone().multiplyScalar(e.invMass/i);t.velocity.subtract(l),e.velocity.add(h)}}},{key:"kick",value:function(t,e){var n=e.position.clone().subtract(t.position).normalize(),r=n.multiplyScalar(t.kickStrength*e.invMass);e.velocity.add(r)}},{key:"discDistanceToLine",value:function(t,e){var n=e.p1.clone().subtract(e.p0),r=t.position.clone().subtract(e.p0);if(r.dot(n)<0)return!1;if(r.dot(n)>0&&(r=t.position.clone().subtract(e.p1)),r.dot(n)>=0)return!1;var i=n.clone().normalize(),o=new p.default(-i.y,i.x);return[o.dot(r),o]}},{key:"handleSegmentCollision",value:function(t,e){var n=this.discDistanceToLine(t,e);if(n!==!1){var r=(0,o.default)(n,2),i=r[0],u=r[1];if(i<0&&(i*=-1,u.invert()),!(i>=t.radius)){var a=u.clone().multiplyScalar(t.radius-i);t.position.add(a);var s=u.dot(t.velocity);if(s<0){var c=s*(t.bounce*e.bounce+1),f=u.clone().multiplyScalar(c);t.velocity.subtract(f)}}}}},{key:"checkGoal",value:function(t,e){if(!this.prevBallPositions[t.id])return!1;var n=this.discDistanceToLine(t,e),r=this.prevBallPositions[t.id],i=this.discDistanceToLine(new v.default(r),e);return n!==!1&&i!==!1?i[0]>0&&n[0]<0||i[0]<0&&n[0]>0:void 0}}]),t}();e.default=y},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(68),o=r(i),u=n(4),a=r(u);e.default=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var u,s=(0,a.default)(t);!(r=(u=s.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if((0,o.default)(Object(e)))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,n){t.exports={default:n(69),__esModule:!0}},function(t,e,n){n(6),n(52),t.exports=n(70)},function(t,e,n){var r=n(56),i=n(49)("iterator"),o=n(10);t.exports=n(19).isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},function(t,e,n){var r;(function(t,i){(function(){function o(t,e){return t.set(e[0],e[1]),t}function u(t,e){return t.add(e),t}function a(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function s(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var u=t[i];e(r,u,n(u),t)}return r}function c(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function f(t,e){for(var n=null==t?0:t.length;n--&&e(t[n],n,t)!==!1;);return t}function l(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function h(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var u=t[n];e(u,n,t)&&(o[i++]=u)}return o}function p(t,e){var n=null==t?0:t.length;return!!n&&S(t,e,0)>-1}function d(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function v(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function y(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function _(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function g(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function m(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function b(t){return t.split("")}function w(t){return t.match(Ye)||[]}function k(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function x(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function S(t,e,n){return e===e?V(t,e,n):x(t,E,n)}function M(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function E(t){return t!==t}function A(t,e){var n=null==t?0:t.length;return n?I(t,e)/n:Rt}function O(t){return function(e){return null==e?it:e[t]}}function T(t){return function(e){return null==t?it:t[e]}}function C(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function P(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function I(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==it&&(n=n===it?o:n+o)}return n}function j(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function B(t,e){return v(e,function(e){return[e,t[e]]})}function D(t){return function(e){return t(e)}}function L(t,e){return v(e,function(e){return t[e]})}function R(t,e){return t.has(e)}function F(t,e){for(var n=-1,r=t.length;++n<r&&S(e,t[n],0)>-1;);return n}function z(t,e){for(var n=t.length;n--&&S(e,t[n],0)>-1;);return n}function U(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}function N(t){return"\\"+nr[t]}function W(t,e){return null==t?it:t[e]}function Y(t){return $n.test(t)}function q(t){return Gn.test(t)}function K(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function X(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function $(t,e){return function(n){return t(e(n))}}function G(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var u=t[n];u!==e&&u!==lt||(t[n]=lt,o[i++]=n)}return o}function H(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function J(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function V(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function Z(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}function Q(t){return Y(t)?et(t):mr(t)}function tt(t){return Y(t)?nt(t):b(t)}function et(t){for(var e=Kn.lastIndex=0;Kn.test(t);)++e;return e}function nt(t){return t.match(Kn)||[]}function rt(t){return t.match(Xn)||[]}var it,ot="4.17.3",ut=200,at="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",st="Expected a function",ct="__lodash_hash_undefined__",ft=500,lt="__lodash_placeholder__",ht=1,pt=2,dt=4,vt=1,yt=2,_t=1,gt=2,mt=4,bt=8,wt=16,kt=32,xt=64,St=128,Mt=256,Et=512,At=30,Ot="...",Tt=800,Ct=16,Pt=1,It=2,jt=3,Bt=1/0,Dt=9007199254740991,Lt=1.7976931348623157e308,Rt=NaN,Ft=4294967295,zt=Ft-1,Ut=Ft>>>1,Nt=[["ary",St],["bind",_t],["bindKey",gt],["curry",bt],["curryRight",wt],["flip",Et],["partial",kt],["partialRight",xt],["rearg",Mt]],Wt="[object Arguments]",Yt="[object Array]",qt="[object AsyncFunction]",Kt="[object Boolean]",Xt="[object Date]",$t="[object DOMException]",Gt="[object Error]",Ht="[object Function]",Jt="[object GeneratorFunction]",Vt="[object Map]",Zt="[object Number]",Qt="[object Null]",te="[object Object]",ee="[object Promise]",ne="[object Proxy]",re="[object RegExp]",ie="[object Set]",oe="[object String]",ue="[object Symbol]",ae="[object Undefined]",se="[object WeakMap]",ce="[object WeakSet]",fe="[object ArrayBuffer]",le="[object DataView]",he="[object Float32Array]",pe="[object Float64Array]",de="[object Int8Array]",ve="[object Int16Array]",ye="[object Int32Array]",_e="[object Uint8Array]",ge="[object Uint8ClampedArray]",me="[object Uint16Array]",be="[object Uint32Array]",we=/\b__p \+= '';/g,ke=/\b(__p \+=) '' \+/g,xe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Se=/&(?:amp|lt|gt|quot|#39);/g,Me=/[&<>"']/g,Ee=RegExp(Se.source),Ae=RegExp(Me.source),Oe=/<%-([\s\S]+?)%>/g,Te=/<%([\s\S]+?)%>/g,Ce=/<%=([\s\S]+?)%>/g,Pe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ie=/^\w*$/,je=/^\./,Be=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,De=/[\\^$.*+?()[\]{}|]/g,Le=RegExp(De.source),Re=/^\s+|\s+$/g,Fe=/^\s+/,ze=/\s+$/,Ue=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ne=/\{\n\/\* \[wrapped with (.+)\] \*/,We=/,? & /,Ye=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qe=/\\(\\)?/g,Ke=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Xe=/\w*$/,$e=/^[-+]0x[0-9a-f]+$/i,Ge=/^0b[01]+$/i,He=/^\[object .+?Constructor\]$/,Je=/^0o[0-7]+$/i,Ve=/^(?:0|[1-9]\d*)$/,Ze=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qe=/($^)/,tn=/['\n\r\u2028\u2029\\]/g,en="\\ud800-\\udfff",nn="\\u0300-\\u036f",rn="\\ufe20-\\ufe2f",on="\\u20d0-\\u20ff",un=nn+rn+on,an="\\u2700-\\u27bf",sn="a-z\\xdf-\\xf6\\xf8-\\xff",cn="\\xac\\xb1\\xd7\\xf7",fn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ln="\\u2000-\\u206f",hn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pn="A-Z\\xc0-\\xd6\\xd8-\\xde",dn="\\ufe0e\\ufe0f",vn=cn+fn+ln+hn,yn="['’]",_n="["+en+"]",gn="["+vn+"]",mn="["+un+"]",bn="\\d+",wn="["+an+"]",kn="["+sn+"]",xn="[^"+en+vn+bn+an+sn+pn+"]",Sn="\\ud83c[\\udffb-\\udfff]",Mn="(?:"+mn+"|"+Sn+")",En="[^"+en+"]",An="(?:\\ud83c[\\udde6-\\uddff]){2}",On="[\\ud800-\\udbff][\\udc00-\\udfff]",Tn="["+pn+"]",Cn="\\u200d",Pn="(?:"+kn+"|"+xn+")",In="(?:"+Tn+"|"+xn+")",jn="(?:"+yn+"(?:d|ll|m|re|s|t|ve))?",Bn="(?:"+yn+"(?:D|LL|M|RE|S|T|VE))?",Dn=Mn+"?",Ln="["+dn+"]?",Rn="(?:"+Cn+"(?:"+[En,An,On].join("|")+")"+Ln+Dn+")*",Fn="\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",zn="\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",Un=Ln+Dn+Rn,Nn="(?:"+[wn,An,On].join("|")+")"+Un,Wn="(?:"+[En+mn+"?",mn,An,On,_n].join("|")+")",Yn=RegExp(yn,"g"),qn=RegExp(mn,"g"),Kn=RegExp(Sn+"(?="+Sn+")|"+Wn+Un,"g"),Xn=RegExp([Tn+"?"+kn+"+"+jn+"(?="+[gn,Tn,"$"].join("|")+")",In+"+"+Bn+"(?="+[gn,Tn+Pn,"$"].join("|")+")",Tn+"?"+Pn+"+"+jn,Tn+"+"+Bn,zn,Fn,bn,Nn].join("|"),"g"),$n=RegExp("["+Cn+en+un+dn+"]"),Gn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Hn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Jn=-1,Vn={};Vn[he]=Vn[pe]=Vn[de]=Vn[ve]=Vn[ye]=Vn[_e]=Vn[ge]=Vn[me]=Vn[be]=!0,Vn[Wt]=Vn[Yt]=Vn[fe]=Vn[Kt]=Vn[le]=Vn[Xt]=Vn[Gt]=Vn[Ht]=Vn[Vt]=Vn[Zt]=Vn[te]=Vn[re]=Vn[ie]=Vn[oe]=Vn[se]=!1;var Zn={};Zn[Wt]=Zn[Yt]=Zn[fe]=Zn[le]=Zn[Kt]=Zn[Xt]=Zn[he]=Zn[pe]=Zn[de]=Zn[ve]=Zn[ye]=Zn[Vt]=Zn[Zt]=Zn[te]=Zn[re]=Zn[ie]=Zn[oe]=Zn[ue]=Zn[_e]=Zn[ge]=Zn[me]=Zn[be]=!0,Zn[Gt]=Zn[Ht]=Zn[se]=!1;var Qn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},tr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},er={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},nr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},rr=parseFloat,ir=parseInt,or="object"==typeof t&&t&&t.Object===Object&&t,ur="object"==typeof self&&self&&self.Object===Object&&self,ar=or||ur||Function("return this")(),sr="object"==typeof e&&e&&!e.nodeType&&e,cr=sr&&"object"==typeof i&&i&&!i.nodeType&&i,fr=cr&&cr.exports===sr,lr=fr&&or.process,hr=function(){try{return lr&&lr.binding&&lr.binding("util")}catch(t){}}(),pr=hr&&hr.isArrayBuffer,dr=hr&&hr.isDate,vr=hr&&hr.isMap,yr=hr&&hr.isRegExp,_r=hr&&hr.isSet,gr=hr&&hr.isTypedArray,mr=O("length"),br=T(Qn),wr=T(tr),kr=T(er),xr=function t(e){function n(t){if(cs(t)&&!wh(t)&&!(t instanceof b)){if(t instanceof i)return t;if(wf.call(t,"__wrapped__"))return uu(t)}return new i(t)}function r(){}function i(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=it}function b(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ft,this.__views__=[]}function T(){var t=new b(this.__wrapped__);return t.__actions__=Ui(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ui(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ui(this.__views__),t}function V(){if(this.__filtered__){var t=new b(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function et(){var t=this.__wrapped__.value(),e=this.__dir__,n=wh(t),r=e<0,i=n?t.length:0,o=Co(0,i,this.__views__),u=o.start,a=o.end,s=a-u,c=r?a:u-1,f=this.__iteratees__,l=f.length,h=0,p=Vf(s,this.__takeCount__);if(!n||!r&&i==s&&p==s)return wi(t,this.__actions__);var d=[];t:for(;s--&&h<p;){c+=e;for(var v=-1,y=t[c];++v<l;){var _=f[v],g=_.iteratee,m=_.type,b=g(y);if(m==It)y=b;else if(!b){if(m==Pt)continue t;break t}}d[h++]=y}return d}function nt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ye(){this.__data__=al?al(null):{},this.size=0}function en(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function nn(t){var e=this.__data__;if(al){var n=e[t];return n===ct?it:n}return wf.call(e,t)?e[t]:it}function rn(t){var e=this.__data__;return al?e[t]!==it:wf.call(e,t)}function on(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=al&&e===it?ct:e,this}function un(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function an(){this.__data__=[],this.size=0}function sn(t){var e=this.__data__,n=jn(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Df.call(e,n,1),--this.size,!0}function cn(t){var e=this.__data__,n=jn(e,t);return n<0?it:e[n][1]}function fn(t){return jn(this.__data__,t)>-1}function ln(t,e){var n=this.__data__,r=jn(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function hn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function pn(){this.size=0,this.__data__={hash:new nt,map:new(rl||un),string:new nt}}function dn(t){var e=Eo(this,t).delete(t);return this.size-=e?1:0,e}function vn(t){return Eo(this,t).get(t)}function yn(t){return Eo(this,t).has(t)}function _n(t,e){var n=Eo(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function gn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new hn;++e<n;)this.add(t[e])}function mn(t){return this.__data__.set(t,ct),this}function bn(t){return this.__data__.has(t)}function wn(t){var e=this.__data__=new un(t);this.size=e.size}function kn(){this.__data__=new un,this.size=0}function xn(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function Sn(t){return this.__data__.get(t)}function Mn(t){return this.__data__.has(t)}function En(t,e){var n=this.__data__;if(n instanceof un){var r=n.__data__;if(!rl||r.length<ut-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new hn(r)}return n.set(t,e),this.size=n.size,this}function An(t,e){var n=wh(t),r=!n&&bh(t),i=!n&&!r&&xh(t),o=!n&&!r&&!i&&Oh(t),u=n||r||i||o,a=u?j(t.length,df):[],s=a.length;for(var c in t)!e&&!wf.call(t,c)||u&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Fo(c,s))||a.push(c);return a}function On(t){var e=t.length;return e?t[ni(0,e-1)]:it}function Tn(t,e){return nu(Ui(t),zn(e,0,t.length))}function Cn(t){return nu(Ui(t))}function Pn(t,e,n){(n===it||Ha(t[e],n))&&(n!==it||e in t)||Rn(t,e,n)}function In(t,e,n){var r=t[e];wf.call(t,e)&&Ha(r,n)&&(n!==it||e in t)||Rn(t,e,n)}function jn(t,e){for(var n=t.length;n--;)if(Ha(t[n][0],e))return n;return-1}function Bn(t,e,n,r){return ml(t,function(t,i,o){e(r,t,n(t),o)}),r}function Dn(t,e){return t&&Ni(e,qs(e),t)}function Ln(t,e){return t&&Ni(e,Ks(e),t)}function Rn(t,e,n){"__proto__"==e&&zf?zf(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Fn(t,e){for(var n=-1,r=e.length,i=af(r),o=null==t;++n<r;)i[n]=o?it:Ns(t,e[n]);return i}function zn(t,e,n){return t===t&&(n!==it&&(t=t<=n?t:n),e!==it&&(t=t>=e?t:e)),t}function Un(t,e,n,r,i,o){var u,a=e&ht,s=e&pt,f=e&dt;if(n&&(u=i?n(t,r,i,o):n(t)),u!==it)return u;if(!ss(t))return t;var l=wh(t);if(l){if(u=jo(t),!a)return Ui(t,u)}else{var h=Pl(t),p=h==Ht||h==Jt;if(xh(t))return Oi(t,a);if(h==te||h==Wt||p&&!i){if(u=s||p?{}:Bo(t),!a)return s?Yi(t,Ln(u,t)):Wi(t,Dn(u,t))}else{if(!Zn[h])return i?t:{};u=Do(t,h,Un,a)}}o||(o=new wn);var d=o.get(t);if(d)return d;o.set(t,u);var v=f?s?ko:wo:s?Ks:qs,y=l?it:v(t);return c(y||t,function(r,i){y&&(i=r,r=t[i]),In(u,i,Un(r,e,n,i,t,o))}),u}function Nn(t){var e=qs(t);return function(n){return Wn(n,t,e)}}function Wn(t,e,n){var r=n.length;if(null==t)return!r;for(t=hf(t);r--;){var i=n[r],o=e[i],u=t[i];if(u===it&&!(i in t)||!o(u))return!1}return!0}function Kn(t,e,n){if("function"!=typeof t)throw new vf(st);return Bl(function(){t.apply(it,n)},e)}function Xn(t,e,n,r){var i=-1,o=p,u=!0,a=t.length,s=[],c=e.length;if(!a)return s;n&&(e=v(e,D(n))),r?(o=d,u=!1):e.length>=ut&&(o=R,u=!1,e=new gn(e));t:for(;++i<a;){var f=t[i],l=null==n?f:n(f);if(f=r||0!==f?f:0,u&&l===l){for(var h=c;h--;)if(e[h]===l)continue t;s.push(f)}else o(e,l,r)||s.push(f)}return s}function $n(t,e){var n=!0;return ml(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Gn(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],u=e(o);if(null!=u&&(a===it?u===u&&!bs(u):n(u,a)))var a=u,s=o}return s}function Qn(t,e,n,r){var i=t.length;for(n=Es(n),n<0&&(n=-n>i?0:i+n),r=r===it||r>i?i:Es(r),r<0&&(r+=i),r=n>r?0:As(r);n<r;)t[n++]=e;return t}function tr(t,e){var n=[];return ml(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function er(t,e,n,r,i){var o=-1,u=t.length;for(n||(n=Ro),i||(i=[]);++o<u;){var a=t[o];e>0&&n(a)?e>1?er(a,e-1,n,r,i):y(i,a):r||(i[i.length]=a)}return i}function nr(t,e){return t&&wl(t,e,qs)}function or(t,e){return t&&kl(t,e,qs)}function ur(t,e){return h(e,function(e){return os(t[e])})}function sr(t,e){e=Ei(e,t);for(var n=0,r=e.length;null!=t&&n<r;)t=t[ru(e[n++])];return n&&n==r?t:it}function cr(t,e,n){var r=e(t);return wh(t)?r:y(r,n(t))}function lr(t){return null==t?t===it?ae:Qt:Ff&&Ff in hf(t)?To(t):Jo(t)}function hr(t,e){return t>e}function mr(t,e){return null!=t&&wf.call(t,e)}function xr(t,e){return null!=t&&e in hf(t)}function Mr(t,e,n){return t>=Vf(e,n)&&t<Jf(e,n)}function Er(t,e,n){for(var r=n?d:p,i=t[0].length,o=t.length,u=o,a=af(o),s=1/0,c=[];u--;){var f=t[u];u&&e&&(f=v(f,D(e))),s=Vf(f.length,s),a[u]=!n&&(e||i>=120&&f.length>=120)?new gn(u&&f):it}f=t[0];var l=-1,h=a[0];t:for(;++l<i&&c.length<s;){var y=f[l],_=e?e(y):y;if(y=n||0!==y?y:0,!(h?R(h,_):r(c,_,n))){for(u=o;--u;){var g=a[u];if(!(g?R(g,_):r(t[u],_,n)))continue t}h&&h.push(_),c.push(y)}}return c}function Ar(t,e,n,r){return nr(t,function(t,i,o){e(r,n(t),i,o)}),r}function Or(t,e,n){e=Ei(e,t),t=Zo(t,e);var r=null==t?t:t[ru(Mu(e))];return null==r?it:a(r,t,n)}function Tr(t){return cs(t)&&lr(t)==Wt}function Cr(t){return cs(t)&&lr(t)==fe}function Pr(t){return cs(t)&&lr(t)==Xt}function Ir(t,e,n,r,i){return t===e||(null==t||null==e||!cs(t)&&!cs(e)?t!==t&&e!==e:jr(t,e,n,r,Ir,i))}function jr(t,e,n,r,i,o){var u=wh(t),a=wh(e),s=u?Yt:Pl(t),c=a?Yt:Pl(e);s=s==Wt?te:s,c=c==Wt?te:c;var f=s==te,l=c==te,h=s==c;if(h&&xh(t)){if(!xh(e))return!1;u=!0,f=!1}if(h&&!f)return o||(o=new wn),u||Oh(t)?_o(t,e,n,r,i,o):go(t,e,s,n,r,i,o);if(!(n&vt)){var p=f&&wf.call(t,"__wrapped__"),d=l&&wf.call(e,"__wrapped__");if(p||d){var v=p?t.value():t,y=d?e.value():e;
return o||(o=new wn),i(v,y,n,r,o)}}return!!h&&(o||(o=new wn),mo(t,e,n,r,i,o))}function Br(t){return cs(t)&&Pl(t)==Vt}function Dr(t,e,n,r){var i=n.length,o=i,u=!r;if(null==t)return!o;for(t=hf(t);i--;){var a=n[i];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){a=n[i];var s=a[0],c=t[s],f=a[1];if(u&&a[2]){if(c===it&&!(s in t))return!1}else{var l=new wn;if(r)var h=r(c,f,s,t,e,l);if(!(h===it?Ir(f,c,vt|yt,r,l):h))return!1}}return!0}function Lr(t){if(!ss(t)||Yo(t))return!1;var e=os(t)?Af:He;return e.test(iu(t))}function Rr(t){return cs(t)&&lr(t)==re}function Fr(t){return cs(t)&&Pl(t)==ie}function zr(t){return cs(t)&&as(t.length)&&!!Vn[lr(t)]}function Ur(t){return"function"==typeof t?t:null==t?Bc:"object"==typeof t?wh(t)?Xr(t[0],t[1]):Kr(t):Wc(t)}function Nr(t){if(!qo(t))return Hf(t);var e=[];for(var n in hf(t))wf.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Wr(t){if(!ss(t))return Ho(t);var e=qo(t),n=[];for(var r in t)("constructor"!=r||!e&&wf.call(t,r))&&n.push(r);return n}function Yr(t,e){return t<e}function qr(t,e){var n=-1,r=Ja(t)?af(t.length):[];return ml(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function Kr(t){var e=Ao(t);return 1==e.length&&e[0][2]?Xo(e[0][0],e[0][1]):function(n){return n===t||Dr(n,t,e)}}function Xr(t,e){return Uo(t)&&Ko(e)?Xo(ru(t),e):function(n){var r=Ns(n,t);return r===it&&r===e?Ys(n,t):Ir(e,r,vt|yt)}}function $r(t,e,n,r,i){t!==e&&wl(e,function(o,u){if(ss(o))i||(i=new wn),Gr(t,e,u,n,$r,r,i);else{var a=r?r(t[u],o,u+"",t,e,i):it;a===it&&(a=o),Pn(t,u,a)}},Ks)}function Gr(t,e,n,r,i,o,u){var a=t[n],s=e[n],c=u.get(s);if(c)return void Pn(t,n,c);var f=o?o(a,s,n+"",t,e,u):it,l=f===it;if(l){var h=wh(s),p=!h&&xh(s),d=!h&&!p&&Oh(s);f=s,h||p||d?wh(a)?f=a:Va(a)?f=Ui(a):p?(l=!1,f=Oi(s,!0)):d?(l=!1,f=Di(s,!0)):f=[]:_s(s)||bh(s)?(f=a,bh(a)?f=Ts(a):(!ss(a)||r&&os(a))&&(f=Bo(s))):l=!1}l&&(u.set(s,f),i(f,s,r,o,u),u.delete(s)),Pn(t,n,f)}function Hr(t,e){var n=t.length;if(n)return e+=e<0?n:0,Fo(e,n)?t[e]:it}function Jr(t,e,n){var r=-1;e=v(e.length?e:[Bc],D(Mo()));var i=qr(t,function(t,n,i){var o=v(e,function(e){return e(t)});return{criteria:o,index:++r,value:t}});return P(i,function(t,e){return Ri(t,e,n)})}function Vr(t,e){return Zr(t,e,function(e,n){return Ys(t,n)})}function Zr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var u=e[r],a=sr(t,u);n(a,u)&&si(o,Ei(u,t),a)}return o}function Qr(t){return function(e){return sr(e,t)}}function ti(t,e,n,r){var i=r?M:S,o=-1,u=e.length,a=t;for(t===e&&(e=Ui(e)),n&&(a=v(t,D(n)));++o<u;)for(var s=0,c=e[o],f=n?n(c):c;(s=i(a,f,s,r))>-1;)a!==t&&Df.call(a,s,1),Df.call(t,s,1);return t}function ei(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;Fo(i)?Df.call(t,i,1):gi(t,i)}}return t}function ni(t,e){return t+qf(tl()*(e-t+1))}function ri(t,e,n,r){for(var i=-1,o=Jf(Yf((e-t)/(n||1)),0),u=af(o);o--;)u[r?o:++i]=t,t+=n;return u}function ii(t,e){var n="";if(!t||e<1||e>Dt)return n;do e%2&&(n+=t),e=qf(e/2),e&&(t+=t);while(e);return n}function oi(t,e){return Dl(Vo(t,e,Bc),t+"")}function ui(t){return On(rc(t))}function ai(t,e){var n=rc(t);return nu(n,zn(e,0,n.length))}function si(t,e,n,r){if(!ss(t))return t;e=Ei(e,t);for(var i=-1,o=e.length,u=o-1,a=t;null!=a&&++i<o;){var s=ru(e[i]),c=n;if(i!=u){var f=a[s];c=r?r(f,s,a):it,c===it&&(c=ss(f)?f:Fo(e[i+1])?[]:{})}In(a,s,c),a=a[s]}return t}function ci(t){return nu(rc(t))}function fi(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=af(i);++r<i;)o[r]=t[r+e];return o}function li(t,e){var n;return ml(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function hi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e===e&&i<=Ut){for(;r<i;){var o=r+i>>>1,u=t[o];null!==u&&!bs(u)&&(n?u<=e:u<e)?r=o+1:i=o}return i}return pi(t,e,Bc,n)}function pi(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,u=e!==e,a=null===e,s=bs(e),c=e===it;i<o;){var f=qf((i+o)/2),l=n(t[f]),h=l!==it,p=null===l,d=l===l,v=bs(l);if(u)var y=r||d;else y=c?d&&(r||h):a?d&&h&&(r||!p):s?d&&h&&!p&&(r||!v):!p&&!v&&(r?l<=e:l<e);y?i=f+1:o=f}return Vf(o,zt)}function di(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var u=t[n],a=e?e(u):u;if(!n||!Ha(a,s)){var s=a;o[i++]=0===u?0:u}}return o}function vi(t){return"number"==typeof t?t:bs(t)?Rt:+t}function yi(t){if("string"==typeof t)return t;if(wh(t))return v(t,yi)+"";if(bs(t))return _l?_l.call(t):"";var e=t+"";return"0"==e&&1/t==-Bt?"-0":e}function _i(t,e,n){var r=-1,i=p,o=t.length,u=!0,a=[],s=a;if(n)u=!1,i=d;else if(o>=ut){var c=e?null:Al(t);if(c)return H(c);u=!1,i=R,s=new gn}else s=e?[]:a;t:for(;++r<o;){var f=t[r],l=e?e(f):f;if(f=n||0!==f?f:0,u&&l===l){for(var h=s.length;h--;)if(s[h]===l)continue t;e&&s.push(l),a.push(f)}else i(s,l,n)||(s!==a&&s.push(l),a.push(f))}return a}function gi(t,e){return e=Ei(e,t),t=Zo(t,e),null==t||delete t[ru(Mu(e))]}function mi(t,e,n,r){return si(t,e,n(sr(t,e)),r)}function bi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?fi(t,r?0:o,r?o+1:i):fi(t,r?o+1:0,r?i:o)}function wi(t,e){var n=t;return n instanceof b&&(n=n.value()),_(e,function(t,e){return e.func.apply(e.thisArg,y([t],e.args))},n)}function ki(t,e,n){var r=t.length;if(r<2)return r?_i(t[0]):[];for(var i=-1,o=af(r);++i<r;)for(var u=t[i],a=-1;++a<r;)a!=i&&(o[i]=Xn(o[i]||u,t[a],e,n));return _i(er(o,1),e,n)}function xi(t,e,n){for(var r=-1,i=t.length,o=e.length,u={};++r<i;){var a=r<o?e[r]:it;n(u,t[r],a)}return u}function Si(t){return Va(t)?t:[]}function Mi(t){return"function"==typeof t?t:Bc}function Ei(t,e){return wh(t)?t:Uo(t,e)?[t]:Ll(Ps(t))}function Ai(t,e,n){var r=t.length;return n=n===it?r:n,!e&&n>=r?t:fi(t,e,n)}function Oi(t,e){if(e)return t.slice();var n=t.length,r=Pf?Pf(n):new t.constructor(n);return t.copy(r),r}function Ti(t){var e=new t.constructor(t.byteLength);return new Cf(e).set(new Cf(t)),e}function Ci(t,e){var n=e?Ti(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Pi(t,e,n){var r=e?n(X(t),ht):X(t);return _(r,o,new t.constructor)}function Ii(t){var e=new t.constructor(t.source,Xe.exec(t));return e.lastIndex=t.lastIndex,e}function ji(t,e,n){var r=e?n(H(t),ht):H(t);return _(r,u,new t.constructor)}function Bi(t){return yl?hf(yl.call(t)):{}}function Di(t,e){var n=e?Ti(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Li(t,e){if(t!==e){var n=t!==it,r=null===t,i=t===t,o=bs(t),u=e!==it,a=null===e,s=e===e,c=bs(e);if(!a&&!c&&!o&&t>e||o&&u&&s&&!a&&!c||r&&u&&s||!n&&s||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||a&&n&&i||!u&&i||!s)return-1}return 0}function Ri(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,u=i.length,a=n.length;++r<u;){var s=Li(i[r],o[r]);if(s){if(r>=a)return s;var c=n[r];return s*("desc"==c?-1:1)}}return t.index-e.index}function Fi(t,e,n,r){for(var i=-1,o=t.length,u=n.length,a=-1,s=e.length,c=Jf(o-u,0),f=af(s+c),l=!r;++a<s;)f[a]=e[a];for(;++i<u;)(l||i<o)&&(f[n[i]]=t[i]);for(;c--;)f[a++]=t[i++];return f}function zi(t,e,n,r){for(var i=-1,o=t.length,u=-1,a=n.length,s=-1,c=e.length,f=Jf(o-a,0),l=af(f+c),h=!r;++i<f;)l[i]=t[i];for(var p=i;++s<c;)l[p+s]=e[s];for(;++u<a;)(h||i<o)&&(l[p+n[u]]=t[i++]);return l}function Ui(t,e){var n=-1,r=t.length;for(e||(e=af(r));++n<r;)e[n]=t[n];return e}function Ni(t,e,n,r){var i=!n;n||(n={});for(var o=-1,u=e.length;++o<u;){var a=e[o],s=r?r(n[a],t[a],a,n,t):it;s===it&&(s=t[a]),i?Rn(n,a,s):In(n,a,s)}return n}function Wi(t,e){return Ni(t,Tl(t),e)}function Yi(t,e){return Ni(t,Cl(t),e)}function qi(t,e){return function(n,r){var i=wh(n)?s:Bn,o=e?e():{};return i(n,t,Mo(r,2),o)}}function Ki(t){return oi(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:it,u=i>2?n[2]:it;for(o=t.length>3&&"function"==typeof o?(i--,o):it,u&&zo(n[0],n[1],u)&&(o=i<3?it:o,i=1),e=hf(e);++r<i;){var a=n[r];a&&t(e,a,r,o)}return e})}function Xi(t,e){return function(n,r){if(null==n)return n;if(!Ja(n))return t(n,r);for(var i=n.length,o=e?i:-1,u=hf(n);(e?o--:++o<i)&&r(u[o],o,u)!==!1;);return n}}function $i(t){return function(e,n,r){for(var i=-1,o=hf(e),u=r(e),a=u.length;a--;){var s=u[t?a:++i];if(n(o[s],s,o)===!1)break}return e}}function Gi(t,e,n){function r(){var e=this&&this!==ar&&this instanceof r?o:t;return e.apply(i?n:this,arguments)}var i=e&_t,o=Vi(t);return r}function Hi(t){return function(e){e=Ps(e);var n=Y(e)?tt(e):it,r=n?n[0]:e.charAt(0),i=n?Ai(n,1).join(""):e.slice(1);return r[t]()+i}}function Ji(t){return function(e){return _(Tc(cc(e).replace(Yn,"")),t,"")}}function Vi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=gl(t.prototype),r=t.apply(n,e);return ss(r)?r:n}}function Zi(t,e,n){function r(){for(var o=arguments.length,u=af(o),s=o,c=So(r);s--;)u[s]=arguments[s];var f=o<3&&u[0]!==c&&u[o-1]!==c?[]:G(u,c);if(o-=f.length,o<n)return co(t,e,eo,r.placeholder,it,u,f,it,it,n-o);var l=this&&this!==ar&&this instanceof r?i:t;return a(l,this,u)}var i=Vi(t);return r}function Qi(t){return function(e,n,r){var i=hf(e);if(!Ja(e)){var o=Mo(n,3);e=qs(e),n=function(t){return o(i[t],t,i)}}var u=t(e,n,r);return u>-1?i[o?e[u]:u]:it}}function to(t){return bo(function(e){var n=e.length,r=n,o=i.prototype.thru;for(t&&e.reverse();r--;){var u=e[r];if("function"!=typeof u)throw new vf(st);if(o&&!a&&"wrapper"==xo(u))var a=new i([],!0)}for(r=a?r:n;++r<n;){u=e[r];var s=xo(u),c="wrapper"==s?Ol(u):it;a=c&&Wo(c[0])&&c[1]==(St|bt|kt|Mt)&&!c[4].length&&1==c[9]?a[xo(c[0])].apply(a,c[3]):1==u.length&&Wo(u)?a[s]():a.thru(u)}return function(){var t=arguments,r=t[0];if(a&&1==t.length&&wh(r))return a.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}function eo(t,e,n,r,i,o,u,a,s,c){function f(){for(var _=arguments.length,g=af(_),m=_;m--;)g[m]=arguments[m];if(d)var b=So(f),w=U(g,b);if(r&&(g=Fi(g,r,i,d)),o&&(g=zi(g,o,u,d)),_-=w,d&&_<c){var k=G(g,b);return co(t,e,eo,f.placeholder,n,g,k,a,s,c-_)}var x=h?n:this,S=p?x[t]:t;return _=g.length,a?g=Qo(g,a):v&&_>1&&g.reverse(),l&&s<_&&(g.length=s),this&&this!==ar&&this instanceof f&&(S=y||Vi(S)),S.apply(x,g)}var l=e&St,h=e&_t,p=e&gt,d=e&(bt|wt),v=e&Et,y=p?it:Vi(t);return f}function no(t,e){return function(n,r){return Ar(n,t,e(r),{})}}function ro(t,e){return function(n,r){var i;if(n===it&&r===it)return e;if(n!==it&&(i=n),r!==it){if(i===it)return r;"string"==typeof n||"string"==typeof r?(n=yi(n),r=yi(r)):(n=vi(n),r=vi(r)),i=t(n,r)}return i}}function io(t){return bo(function(e){return e=v(e,D(Mo())),oi(function(n){var r=this;return t(e,function(t){return a(t,r,n)})})})}function oo(t,e){e=e===it?" ":yi(e);var n=e.length;if(n<2)return n?ii(e,t):e;var r=ii(e,Yf(t/Q(e)));return Y(e)?Ai(tt(r),0,t).join(""):r.slice(0,t)}function uo(t,e,n,r){function i(){for(var e=-1,s=arguments.length,c=-1,f=r.length,l=af(f+s),h=this&&this!==ar&&this instanceof i?u:t;++c<f;)l[c]=r[c];for(;s--;)l[c++]=arguments[++e];return a(h,o?n:this,l)}var o=e&_t,u=Vi(t);return i}function ao(t){return function(e,n,r){return r&&"number"!=typeof r&&zo(e,n,r)&&(n=r=it),e=Ms(e),n===it?(n=e,e=0):n=Ms(n),r=r===it?e<n?1:-1:Ms(r),ri(e,n,r,t)}}function so(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Os(e),n=Os(n)),t(e,n)}}function co(t,e,n,r,i,o,u,a,s,c){var f=e&bt,l=f?u:it,h=f?it:u,p=f?o:it,d=f?it:o;e|=f?kt:xt,e&=~(f?xt:kt),e&mt||(e&=~(_t|gt));var v=[t,e,i,p,l,d,h,a,s,c],y=n.apply(it,v);return Wo(t)&&jl(y,v),y.placeholder=r,tu(y,t,e)}function fo(t){var e=lf[t];return function(t,n){if(t=Os(t),n=null==n?0:Vf(Es(n),292)){var r=(Ps(t)+"e").split("e"),i=e(r[0]+"e"+(+r[1]+n));return r=(Ps(i)+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return e(t)}}function lo(t){return function(e){var n=Pl(e);return n==Vt?X(e):n==ie?J(e):B(e,t(e))}}function ho(t,e,n,r,i,o,u,a){var s=e&gt;if(!s&&"function"!=typeof t)throw new vf(st);var c=r?r.length:0;if(c||(e&=~(kt|xt),r=i=it),u=u===it?u:Jf(Es(u),0),a=a===it?a:Es(a),c-=i?i.length:0,e&xt){var f=r,l=i;r=i=it}var h=s?it:Ol(t),p=[t,e,n,r,i,f,l,o,u,a];if(h&&Go(p,h),t=p[0],e=p[1],n=p[2],r=p[3],i=p[4],a=p[9]=p[9]===it?s?0:t.length:Jf(p[9]-c,0),!a&&e&(bt|wt)&&(e&=~(bt|wt)),e&&e!=_t)d=e==bt||e==wt?Zi(t,e,a):e!=kt&&e!=(_t|kt)||i.length?eo.apply(it,p):uo(t,e,n,r);else var d=Gi(t,e,n);var v=h?xl:jl;return tu(v(d,p),t,e)}function po(t,e,n,r){return t===it||Ha(t,gf[n])&&!wf.call(r,n)?e:t}function vo(t,e,n,r,i,o){return ss(t)&&ss(e)&&(o.set(e,t),$r(t,e,it,vo,o),o.delete(e)),t}function yo(t,e){return e!==it&&_s(t)?it:t}function _o(t,e,n,r,i,o){var u=n&vt,a=t.length,s=e.length;if(a!=s&&!(u&&s>a))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var f=-1,l=!0,h=n&yt?new gn:it;for(o.set(t,e),o.set(e,t);++f<a;){var p=t[f],d=e[f];if(r)var v=u?r(d,p,f,e,t,o):r(p,d,f,t,e,o);if(v!==it){if(v)continue;l=!1;break}if(h){if(!m(e,function(t,e){if(!R(h,e)&&(p===t||i(p,t,n,r,o)))return h.push(e)})){l=!1;break}}else if(p!==d&&!i(p,d,n,r,o)){l=!1;break}}return o.delete(t),o.delete(e),l}function go(t,e,n,r,i,o,u){switch(n){case le:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case fe:return!(t.byteLength!=e.byteLength||!o(new Cf(t),new Cf(e)));case Kt:case Xt:case Zt:return Ha(+t,+e);case Gt:return t.name==e.name&&t.message==e.message;case re:case oe:return t==e+"";case Vt:var a=X;case ie:var s=r&vt;if(a||(a=H),t.size!=e.size&&!s)return!1;var c=u.get(t);if(c)return c==e;r|=yt,u.set(t,e);var f=_o(a(t),a(e),r,i,o,u);return u.delete(t),f;case ue:if(yl)return yl.call(t)==yl.call(e)}return!1}function mo(t,e,n,r,i,o){var u=n&vt,a=wo(t),s=a.length,c=wo(e),f=c.length;if(s!=f&&!u)return!1;for(var l=s;l--;){var h=a[l];if(!(u?h in e:wf.call(e,h)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var d=!0;o.set(t,e),o.set(e,t);for(var v=u;++l<s;){h=a[l];var y=t[h],_=e[h];if(r)var g=u?r(_,y,h,e,t,o):r(y,_,h,t,e,o);if(!(g===it?y===_||i(y,_,n,r,o):g)){d=!1;break}v||(v="constructor"==h)}if(d&&!v){var m=t.constructor,b=e.constructor;m!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b)&&(d=!1)}return o.delete(t),o.delete(e),d}function bo(t){return Dl(Vo(t,it,_u),t+"")}function wo(t){return cr(t,qs,Tl)}function ko(t){return cr(t,Ks,Cl)}function xo(t){for(var e=t.name+"",n=cl[e],r=wf.call(cl,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function So(t){var e=wf.call(n,"placeholder")?n:t;return e.placeholder}function Mo(){var t=n.iteratee||Dc;return t=t===Dc?Ur:t,arguments.length?t(arguments[0],arguments[1]):t}function Eo(t,e){var n=t.__data__;return No(e)?n["string"==typeof e?"string":"hash"]:n.map}function Ao(t){for(var e=qs(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Ko(i)]}return e}function Oo(t,e){var n=W(t,e);return Lr(n)?n:it}function To(t){var e=wf.call(t,Ff),n=t[Ff];try{t[Ff]=it;var r=!0}catch(t){}var i=Sf.call(t);return r&&(e?t[Ff]=n:delete t[Ff]),i}function Co(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],u=o.size;switch(o.type){case"drop":t+=u;break;case"dropRight":e-=u;break;case"take":e=Vf(e,t+u);break;case"takeRight":t=Jf(t,e-u)}}return{start:t,end:e}}function Po(t){var e=t.match(Ne);return e?e[1].split(We):[]}function Io(t,e,n){e=Ei(e,t);for(var r=-1,i=e.length,o=!1;++r<i;){var u=ru(e[r]);if(!(o=null!=t&&n(t,u)))break;t=t[u]}return o||++r!=i?o:(i=null==t?0:t.length,!!i&&as(i)&&Fo(u,i)&&(wh(t)||bh(t)))}function jo(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&wf.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Bo(t){return"function"!=typeof t.constructor||qo(t)?{}:gl(If(t))}function Do(t,e,n,r){var i=t.constructor;switch(e){case fe:return Ti(t);case Kt:case Xt:return new i(+t);case le:return Ci(t,r);case he:case pe:case de:case ve:case ye:case _e:case ge:case me:case be:return Di(t,r);case Vt:return Pi(t,r,n);case Zt:case oe:return new i(t);case re:return Ii(t);case ie:return ji(t,r,n);case ue:return Bi(t)}}function Lo(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Ue,"{\n/* [wrapped with "+e+"] */\n")}function Ro(t){return wh(t)||bh(t)||!!(Lf&&t&&t[Lf])}function Fo(t,e){return e=null==e?Dt:e,!!e&&("number"==typeof t||Ve.test(t))&&t>-1&&t%1==0&&t<e}function zo(t,e,n){if(!ss(n))return!1;var r=typeof e;return!!("number"==r?Ja(n)&&Fo(e,n.length):"string"==r&&e in n)&&Ha(n[e],t)}function Uo(t,e){if(wh(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!bs(t))||(Ie.test(t)||!Pe.test(t)||null!=e&&t in hf(e))}function No(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function Wo(t){var e=xo(t),r=n[e];if("function"!=typeof r||!(e in b.prototype))return!1;if(t===r)return!0;var i=Ol(r);return!!i&&t===i[0]}function Yo(t){return!!xf&&xf in t}function qo(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||gf;return t===n}function Ko(t){return t===t&&!ss(t)}function Xo(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==it||t in hf(n)))}}function $o(t){var e=Da(t,function(t){return n.size===ft&&n.clear(),t}),n=e.cache;return e}function Go(t,e){var n=t[1],r=e[1],i=n|r,o=i<(_t|gt|St),u=r==St&&n==bt||r==St&&n==Mt&&t[7].length<=e[8]||r==(St|Mt)&&e[7].length<=e[8]&&n==bt;if(!o&&!u)return t;r&_t&&(t[2]=e[2],i|=n&_t?0:mt);var a=e[3];if(a){var s=t[3];t[3]=s?Fi(s,a,e[4]):a,t[4]=s?G(t[3],lt):e[4]}return a=e[5],a&&(s=t[5],t[5]=s?zi(s,a,e[6]):a,t[6]=s?G(t[5],lt):e[6]),a=e[7],a&&(t[7]=a),r&St&&(t[8]=null==t[8]?e[8]:Vf(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function Ho(t){var e=[];if(null!=t)for(var n in hf(t))e.push(n);return e}function Jo(t){return Sf.call(t)}function Vo(t,e,n){return e=Jf(e===it?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=Jf(r.length-e,0),u=af(o);++i<o;)u[i]=r[e+i];i=-1;for(var s=af(e+1);++i<e;)s[i]=r[i];return s[e]=n(u),a(t,this,s)}}function Zo(t,e){return e.length<2?t:sr(t,fi(e,0,-1))}function Qo(t,e){for(var n=t.length,r=Vf(e.length,n),i=Ui(t);r--;){var o=e[r];t[r]=Fo(o,n)?i[o]:it}return t}function tu(t,e,n){var r=e+"";return Dl(t,Lo(r,ou(Po(r),n)))}function eu(t){var e=0,n=0;return function(){var r=Zf(),i=Ct-(r-n);if(n=r,i>0){if(++e>=Tt)return arguments[0]}else e=0;return t.apply(it,arguments)}}function nu(t,e){var n=-1,r=t.length,i=r-1;for(e=e===it?r:e;++n<e;){var o=ni(n,i),u=t[o];t[o]=t[n],t[n]=u}return t.length=e,t}function ru(t){if("string"==typeof t||bs(t))return t;var e=t+"";return"0"==e&&1/t==-Bt?"-0":e}function iu(t){if(null!=t){try{return bf.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function ou(t,e){return c(Nt,function(n){var r="_."+n[0];e&n[1]&&!p(t,r)&&t.push(r)}),t.sort()}function uu(t){if(t instanceof b)return t.clone();var e=new i(t.__wrapped__,t.__chain__);return e.__actions__=Ui(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function au(t,e,n){e=(n?zo(t,e,n):e===it)?1:Jf(Es(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,u=af(Yf(r/e));i<r;)u[o++]=fi(t,i,i+=e);return u}function su(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i}function cu(){var t=arguments.length;if(!t)return[];for(var e=af(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return y(wh(n)?Ui(n):[n],er(e,1))}function fu(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===it?1:Es(e),fi(t,e<0?0:e,r)):[]}function lu(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===it?1:Es(e),e=r-e,fi(t,0,e<0?0:e)):[]}function hu(t,e){return t&&t.length?bi(t,Mo(e,3),!0,!0):[]}function pu(t,e){return t&&t.length?bi(t,Mo(e,3),!0):[]}function du(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&zo(t,e,n)&&(n=0,r=i),Qn(t,e,n,r)):[]}function vu(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Es(n);return i<0&&(i=Jf(r+i,0)),x(t,Mo(e,3),i)}function yu(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==it&&(i=Es(n),i=n<0?Jf(r+i,0):Vf(i,r-1)),x(t,Mo(e,3),i,!0)}function _u(t){var e=null==t?0:t.length;return e?er(t,1):[]}function gu(t){var e=null==t?0:t.length;return e?er(t,Bt):[]}function mu(t,e){var n=null==t?0:t.length;return n?(e=e===it?1:Es(e),er(t,e)):[]}function bu(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r}function wu(t){return t&&t.length?t[0]:it}function ku(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Es(n);return i<0&&(i=Jf(r+i,0)),S(t,e,i)}function xu(t){var e=null==t?0:t.length;return e?fi(t,0,-1):[]}function Su(t,e){return null==t?"":Gf.call(t,e)}function Mu(t){var e=null==t?0:t.length;return e?t[e-1]:it}function Eu(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==it&&(i=Es(n),i=i<0?Jf(r+i,0):Vf(i,r-1)),e===e?Z(t,e,i):x(t,E,i,!0)}function Au(t,e){return t&&t.length?Hr(t,Es(e)):it}function Ou(t,e){return t&&t.length&&e&&e.length?ti(t,e):t}function Tu(t,e,n){return t&&t.length&&e&&e.length?ti(t,e,Mo(n,2)):t}function Cu(t,e,n){return t&&t.length&&e&&e.length?ti(t,e,it,n):t}function Pu(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Mo(e,3);++r<o;){var u=t[r];e(u,r,t)&&(n.push(u),i.push(r))}return ei(t,i),n}function Iu(t){return null==t?t:el.call(t)}function ju(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&zo(t,e,n)?(e=0,n=r):(e=null==e?0:Es(e),n=n===it?r:Es(n)),fi(t,e,n)):[]}function Bu(t,e){return hi(t,e)}function Du(t,e,n){return pi(t,e,Mo(n,2))}function Lu(t,e){var n=null==t?0:t.length;if(n){var r=hi(t,e);if(r<n&&Ha(t[r],e))return r}return-1}function Ru(t,e){return hi(t,e,!0)}function Fu(t,e,n){return pi(t,e,Mo(n,2),!0)}function zu(t,e){var n=null==t?0:t.length;if(n){var r=hi(t,e,!0)-1;if(Ha(t[r],e))return r}return-1}function Uu(t){return t&&t.length?di(t):[]}function Nu(t,e){return t&&t.length?di(t,Mo(e,2)):[]}function Wu(t){var e=null==t?0:t.length;return e?fi(t,1,e):[]}function Yu(t,e,n){return t&&t.length?(e=n||e===it?1:Es(e),fi(t,0,e<0?0:e)):[]}function qu(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===it?1:Es(e),e=r-e,fi(t,e<0?0:e,r)):[]}function Ku(t,e){return t&&t.length?bi(t,Mo(e,3),!1,!0):[]}function Xu(t,e){return t&&t.length?bi(t,Mo(e,3)):[]}function $u(t){return t&&t.length?_i(t):[]}function Gu(t,e){return t&&t.length?_i(t,Mo(e,2)):[]}function Hu(t,e){return e="function"==typeof e?e:it,t&&t.length?_i(t,it,e):[]}function Ju(t){if(!t||!t.length)return[];var e=0;return t=h(t,function(t){if(Va(t))return e=Jf(t.length,e),!0}),j(e,function(e){return v(t,O(e))})}function Vu(t,e){if(!t||!t.length)return[];var n=Ju(t);return null==e?n:v(n,function(t){return a(e,it,t)})}function Zu(t,e){return xi(t||[],e||[],In)}function Qu(t,e){return xi(t||[],e||[],si)}function ta(t){var e=n(t);return e.__chain__=!0,e}function ea(t,e){return e(t),t}function na(t,e){return e(t)}function ra(){return ta(this)}function ia(){return new i(this.value(),this.__chain__)}function oa(){this.__values__===it&&(this.__values__=Ss(this.value()));var t=this.__index__>=this.__values__.length,e=t?it:this.__values__[this.__index__++];return{done:t,value:e}}function ua(){return this}function aa(t){for(var e,n=this;n instanceof r;){var i=uu(n);i.__index__=0,i.__values__=it,e?o.__wrapped__=i:e=i;var o=i;n=n.__wrapped__}return o.__wrapped__=t,e}function sa(){var t=this.__wrapped__;if(t instanceof b){var e=t;return this.__actions__.length&&(e=new b(this)),e=e.reverse(),e.__actions__.push({func:na,args:[Iu],thisArg:it}),new i(e,this.__chain__)}return this.thru(Iu)}function ca(){return wi(this.__wrapped__,this.__actions__)}function fa(t,e,n){var r=wh(t)?l:$n;return n&&zo(t,e,n)&&(e=it),r(t,Mo(e,3))}function la(t,e){var n=wh(t)?h:tr;return n(t,Mo(e,3))}function ha(t,e){return er(ga(t,e),1)}function pa(t,e){return er(ga(t,e),Bt)}function da(t,e,n){return n=n===it?1:Es(n),er(ga(t,e),n)}function va(t,e){var n=wh(t)?c:ml;return n(t,Mo(e,3))}function ya(t,e){var n=wh(t)?f:bl;return n(t,Mo(e,3))}function _a(t,e,n,r){t=Ja(t)?t:rc(t),n=n&&!r?Es(n):0;var i=t.length;return n<0&&(n=Jf(i+n,0)),ms(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&S(t,e,n)>-1}function ga(t,e){var n=wh(t)?v:qr;return n(t,Mo(e,3))}function ma(t,e,n,r){return null==t?[]:(wh(e)||(e=null==e?[]:[e]),n=r?it:n,wh(n)||(n=null==n?[]:[n]),Jr(t,e,n))}function ba(t,e,n){var r=wh(t)?_:C,i=arguments.length<3;return r(t,Mo(e,4),n,i,ml)}function wa(t,e,n){var r=wh(t)?g:C,i=arguments.length<3;return r(t,Mo(e,4),n,i,bl)}function ka(t,e){var n=wh(t)?h:tr;return n(t,La(Mo(e,3)))}function xa(t){var e=wh(t)?On:ui;return e(t)}function Sa(t,e,n){e=(n?zo(t,e,n):e===it)?1:Es(e);var r=wh(t)?Tn:ai;return r(t,e)}function Ma(t){var e=wh(t)?Cn:ci;return e(t)}function Ea(t){if(null==t)return 0;if(Ja(t))return ms(t)?Q(t):t.length;var e=Pl(t);return e==Vt||e==ie?t.size:Nr(t).length}function Aa(t,e,n){var r=wh(t)?m:li;return n&&zo(t,e,n)&&(e=it),r(t,Mo(e,3))}function Oa(t,e){if("function"!=typeof e)throw new vf(st);return t=Es(t),function(){if(--t<1)return e.apply(this,arguments)}}function Ta(t,e,n){return e=n?it:e,e=t&&null==e?t.length:e,ho(t,St,it,it,it,it,e)}function Ca(t,e){var n;if("function"!=typeof e)throw new vf(st);return t=Es(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=it),n}}function Pa(t,e,n){e=n?it:e;var r=ho(t,bt,it,it,it,it,it,e);return r.placeholder=Pa.placeholder,r}function Ia(t,e,n){e=n?it:e;var r=ho(t,wt,it,it,it,it,it,e);return r.placeholder=Ia.placeholder,r}function ja(t,e,n){function r(e){var n=h,r=p;return h=p=it,g=e,v=t.apply(r,n)}function i(t){return g=t,y=Bl(a,e),m?r(t):v}function o(t){var n=t-_,r=t-g,i=e-n;return b?Vf(i,d-r):i}function u(t){var n=t-_,r=t-g;return _===it||n>=e||n<0||b&&r>=d}function a(){var t=ch();return u(t)?s(t):void(y=Bl(a,o(t)))}function s(t){return y=it,w&&h?r(t):(h=p=it,v)}function c(){y!==it&&El(y),g=0,h=_=p=y=it}function f(){return y===it?v:s(ch())}function l(){var t=ch(),n=u(t);if(h=arguments,p=this,_=t,n){if(y===it)return i(_);if(b)return y=Bl(a,e),r(_)}return y===it&&(y=Bl(a,e)),v}var h,p,d,v,y,_,g=0,m=!1,b=!1,w=!0;if("function"!=typeof t)throw new vf(st);return e=Os(e)||0,ss(n)&&(m=!!n.leading,b="maxWait"in n,d=b?Jf(Os(n.maxWait)||0,e):d,w="trailing"in n?!!n.trailing:w),l.cancel=c,l.flush=f,l}function Ba(t){return ho(t,Et)}function Da(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new vf(st);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var u=t.apply(this,r);return n.cache=o.set(i,u)||o,u};return n.cache=new(Da.Cache||hn),n}function La(t){if("function"!=typeof t)throw new vf(st);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Ra(t){return Ca(2,t)}function Fa(t,e){if("function"!=typeof t)throw new vf(st);return e=e===it?e:Es(e),oi(t,e)}function za(t,e){if("function"!=typeof t)throw new vf(st);return e=null==e?0:Jf(Es(e),0),oi(function(n){var r=n[e],i=Ai(n,0,e);return r&&y(i,r),a(t,this,i)})}function Ua(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new vf(st);return ss(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),ja(t,e,{leading:r,maxWait:e,trailing:i})}function Na(t){return Ta(t,1)}function Wa(t,e){return vh(Mi(e),t)}function Ya(){if(!arguments.length)return[];var t=arguments[0];return wh(t)?t:[t]}function qa(t){return Un(t,dt)}function Ka(t,e){return e="function"==typeof e?e:it,Un(t,dt,e)}function Xa(t){return Un(t,ht|dt)}function $a(t,e){return e="function"==typeof e?e:it,Un(t,ht|dt,e)}function Ga(t,e){return null==e||Wn(t,e,qs(e))}function Ha(t,e){return t===e||t!==t&&e!==e}function Ja(t){return null!=t&&as(t.length)&&!os(t)}function Va(t){return cs(t)&&Ja(t)}function Za(t){return t===!0||t===!1||cs(t)&&lr(t)==Kt}function Qa(t){return cs(t)&&1===t.nodeType&&!_s(t)}function ts(t){if(null==t)return!0;if(Ja(t)&&(wh(t)||"string"==typeof t||"function"==typeof t.splice||xh(t)||Oh(t)||bh(t)))return!t.length;var e=Pl(t);if(e==Vt||e==ie)return!t.size;if(qo(t))return!Nr(t).length;for(var n in t)if(wf.call(t,n))return!1;return!0}function es(t,e){return Ir(t,e)}function ns(t,e,n){n="function"==typeof n?n:it;var r=n?n(t,e):it;return r===it?Ir(t,e,it,n):!!r}function rs(t){if(!cs(t))return!1;var e=lr(t);return e==Gt||e==$t||"string"==typeof t.message&&"string"==typeof t.name&&!_s(t)}function is(t){return"number"==typeof t&&$f(t)}function os(t){if(!ss(t))return!1;var e=lr(t);return e==Ht||e==Jt||e==qt||e==ne}function us(t){return"number"==typeof t&&t==Es(t)}function as(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Dt}function ss(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function cs(t){return null!=t&&"object"==typeof t}function fs(t,e){return t===e||Dr(t,e,Ao(e))}function ls(t,e,n){return n="function"==typeof n?n:it,Dr(t,e,Ao(e),n)}function hs(t){return ys(t)&&t!=+t}function ps(t){if(Il(t))throw new cf(at);return Lr(t)}function ds(t){return null===t}function vs(t){return null==t}function ys(t){return"number"==typeof t||cs(t)&&lr(t)==Zt}function _s(t){if(!cs(t)||lr(t)!=te)return!1;var e=If(t);if(null===e)return!0;var n=wf.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&bf.call(n)==Mf}function gs(t){return us(t)&&t>=-Dt&&t<=Dt}function ms(t){return"string"==typeof t||!wh(t)&&cs(t)&&lr(t)==oe}function bs(t){return"symbol"==typeof t||cs(t)&&lr(t)==ue}function ws(t){return t===it}function ks(t){return cs(t)&&Pl(t)==se}function xs(t){return cs(t)&&lr(t)==ce}function Ss(t){if(!t)return[];if(Ja(t))return ms(t)?tt(t):Ui(t);if(Rf&&t[Rf])return K(t[Rf]());var e=Pl(t),n=e==Vt?X:e==ie?H:rc;return n(t)}function Ms(t){if(!t)return 0===t?t:0;if(t=Os(t),t===Bt||t===-Bt){var e=t<0?-1:1;return e*Lt}return t===t?t:0}function Es(t){var e=Ms(t),n=e%1;return e===e?n?e-n:e:0}function As(t){return t?zn(Es(t),0,Ft):0}function Os(t){if("number"==typeof t)return t;if(bs(t))return Rt;if(ss(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ss(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Re,"");var n=Ge.test(t);return n||Je.test(t)?ir(t.slice(2),n?2:8):$e.test(t)?Rt:+t}function Ts(t){return Ni(t,Ks(t))}function Cs(t){return t?zn(Es(t),-Dt,Dt):0===t?t:0}function Ps(t){return null==t?"":yi(t)}function Is(t,e){var n=gl(t);return null==e?n:Dn(n,e)}function js(t,e){return k(t,Mo(e,3),nr)}function Bs(t,e){return k(t,Mo(e,3),or)}function Ds(t,e){return null==t?t:wl(t,Mo(e,3),Ks)}function Ls(t,e){return null==t?t:kl(t,Mo(e,3),Ks)}function Rs(t,e){return t&&nr(t,Mo(e,3))}function Fs(t,e){return t&&or(t,Mo(e,3))}function zs(t){return null==t?[]:ur(t,qs(t))}function Us(t){return null==t?[]:ur(t,Ks(t))}function Ns(t,e,n){var r=null==t?it:sr(t,e);return r===it?n:r}function Ws(t,e){return null!=t&&Io(t,e,mr)}function Ys(t,e){return null!=t&&Io(t,e,xr)}function qs(t){return Ja(t)?An(t):Nr(t)}function Ks(t){return Ja(t)?An(t,!0):Wr(t)}function Xs(t,e){var n={};return e=Mo(e,3),nr(t,function(t,r,i){Rn(n,e(t,r,i),t)}),n}function $s(t,e){var n={};return e=Mo(e,3),nr(t,function(t,r,i){Rn(n,r,e(t,r,i))}),n}function Gs(t,e){return Hs(t,La(Mo(e)))}function Hs(t,e){if(null==t)return{};var n=v(ko(t),function(t){return[t]});return e=Mo(e),Zr(t,n,function(t,n){return e(t,n[0])})}function Js(t,e,n){e=Ei(e,t);var r=-1,i=e.length;for(i||(i=1,t=it);++r<i;){var o=null==t?it:t[ru(e[r])];o===it&&(r=i,o=n),t=os(o)?o.call(t):o}return t}function Vs(t,e,n){return null==t?t:si(t,e,n)}function Zs(t,e,n,r){return r="function"==typeof r?r:it,null==t?t:si(t,e,n,r)}function Qs(t,e,n){var r=wh(t),i=r||xh(t)||Oh(t);if(e=Mo(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:ss(t)&&os(o)?gl(If(t)):{}}return(i?c:nr)(t,function(t,r,i){return e(n,t,r,i)}),n}function tc(t,e){return null==t||gi(t,e)}function ec(t,e,n){return null==t?t:mi(t,e,Mi(n))}function nc(t,e,n,r){return r="function"==typeof r?r:it,null==t?t:mi(t,e,Mi(n),r)}function rc(t){return null==t?[]:L(t,qs(t))}function ic(t){return null==t?[]:L(t,Ks(t))}function oc(t,e,n){return n===it&&(n=e,e=it),n!==it&&(n=Os(n),n=n===n?n:0),e!==it&&(e=Os(e),e=e===e?e:0),zn(Os(t),e,n)}function uc(t,e,n){
return e=Ms(e),n===it?(n=e,e=0):n=Ms(n),t=Os(t),Mr(t,e,n)}function ac(t,e,n){if(n&&"boolean"!=typeof n&&zo(t,e,n)&&(e=n=it),n===it&&("boolean"==typeof e?(n=e,e=it):"boolean"==typeof t&&(n=t,t=it)),t===it&&e===it?(t=0,e=1):(t=Ms(t),e===it?(e=t,t=0):e=Ms(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=tl();return Vf(t+i*(e-t+rr("1e-"+((i+"").length-1))),e)}return ni(t,e)}function sc(t){return tp(Ps(t).toLowerCase())}function cc(t){return t=Ps(t),t&&t.replace(Ze,br).replace(qn,"")}function fc(t,e,n){t=Ps(t),e=yi(e);var r=t.length;n=n===it?r:zn(Es(n),0,r);var i=n;return n-=e.length,n>=0&&t.slice(n,i)==e}function lc(t){return t=Ps(t),t&&Ae.test(t)?t.replace(Me,wr):t}function hc(t){return t=Ps(t),t&&Le.test(t)?t.replace(De,"\\$&"):t}function pc(t,e,n){t=Ps(t),e=Es(e);var r=e?Q(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return oo(qf(i),n)+t+oo(Yf(i),n)}function dc(t,e,n){t=Ps(t),e=Es(e);var r=e?Q(t):0;return e&&r<e?t+oo(e-r,n):t}function vc(t,e,n){t=Ps(t),e=Es(e);var r=e?Q(t):0;return e&&r<e?oo(e-r,n)+t:t}function yc(t,e,n){return n||null==e?e=0:e&&(e=+e),Qf(Ps(t).replace(Fe,""),e||0)}function _c(t,e,n){return e=(n?zo(t,e,n):e===it)?1:Es(e),ii(Ps(t),e)}function gc(){var t=arguments,e=Ps(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function mc(t,e,n){return n&&"number"!=typeof n&&zo(t,e,n)&&(e=n=it),(n=n===it?Ft:n>>>0)?(t=Ps(t),t&&("string"==typeof e||null!=e&&!Eh(e))&&(e=yi(e),!e&&Y(t))?Ai(tt(t),0,n):t.split(e,n)):[]}function bc(t,e,n){return t=Ps(t),n=null==n?0:zn(Es(n),0,t.length),e=yi(e),t.slice(n,n+e.length)==e}function wc(t,e,r){var i=n.templateSettings;r&&zo(t,e,r)&&(e=it),t=Ps(t),e=jh({},e,i,po);var o,u,a=jh({},e.imports,i.imports,po),s=qs(a),c=L(a,s),f=0,l=e.interpolate||Qe,h="__p += '",p=pf((e.escape||Qe).source+"|"+l.source+"|"+(l===Ce?Ke:Qe).source+"|"+(e.evaluate||Qe).source+"|$","g"),d="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++Jn+"]")+"\n";t.replace(p,function(e,n,r,i,a,s){return r||(r=i),h+=t.slice(f,s).replace(tn,N),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(u=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),f=s+e.length,e}),h+="';\n";var v=e.variable;v||(h="with (obj) {\n"+h+"\n}\n"),h=(u?h.replace(we,""):h).replace(ke,"$1").replace(xe,"$1;"),h="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var y=ep(function(){return ff(s,d+"return "+h).apply(it,c)});if(y.source=h,rs(y))throw y;return y}function kc(t){return Ps(t).toLowerCase()}function xc(t){return Ps(t).toUpperCase()}function Sc(t,e,n){if(t=Ps(t),t&&(n||e===it))return t.replace(Re,"");if(!t||!(e=yi(e)))return t;var r=tt(t),i=tt(e),o=F(r,i),u=z(r,i)+1;return Ai(r,o,u).join("")}function Mc(t,e,n){if(t=Ps(t),t&&(n||e===it))return t.replace(ze,"");if(!t||!(e=yi(e)))return t;var r=tt(t),i=z(r,tt(e))+1;return Ai(r,0,i).join("")}function Ec(t,e,n){if(t=Ps(t),t&&(n||e===it))return t.replace(Fe,"");if(!t||!(e=yi(e)))return t;var r=tt(t),i=F(r,tt(e));return Ai(r,i).join("")}function Ac(t,e){var n=At,r=Ot;if(ss(e)){var i="separator"in e?e.separator:i;n="length"in e?Es(e.length):n,r="omission"in e?yi(e.omission):r}t=Ps(t);var o=t.length;if(Y(t)){var u=tt(t);o=u.length}if(n>=o)return t;var a=n-Q(r);if(a<1)return r;var s=u?Ai(u,0,a).join(""):t.slice(0,a);if(i===it)return s+r;if(u&&(a+=s.length-a),Eh(i)){if(t.slice(a).search(i)){var c,f=s;for(i.global||(i=pf(i.source,Ps(Xe.exec(i))+"g")),i.lastIndex=0;c=i.exec(f);)var l=c.index;s=s.slice(0,l===it?a:l)}}else if(t.indexOf(yi(i),a)!=a){var h=s.lastIndexOf(i);h>-1&&(s=s.slice(0,h))}return s+r}function Oc(t){return t=Ps(t),t&&Ee.test(t)?t.replace(Se,kr):t}function Tc(t,e,n){return t=Ps(t),e=n?it:e,e===it?q(t)?rt(t):w(t):t.match(e)||[]}function Cc(t){var e=null==t?0:t.length,n=Mo();return t=e?v(t,function(t){if("function"!=typeof t[1])throw new vf(st);return[n(t[0]),t[1]]}):[],oi(function(n){for(var r=-1;++r<e;){var i=t[r];if(a(i[0],this,n))return a(i[1],this,n)}})}function Pc(t){return Nn(Un(t,ht))}function Ic(t){return function(){return t}}function jc(t,e){return null==t||t!==t?e:t}function Bc(t){return t}function Dc(t){return Ur("function"==typeof t?t:Un(t,ht))}function Lc(t){return Kr(Un(t,ht))}function Rc(t,e){return Xr(t,Un(e,ht))}function Fc(t,e,n){var r=qs(e),i=ur(e,r);null!=n||ss(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=ur(e,qs(e)));var o=!(ss(n)&&"chain"in n&&!n.chain),u=os(t);return c(i,function(n){var r=e[n];t[n]=r,u&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=Ui(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,y([this.value()],arguments))})}),t}function zc(){return ar._===this&&(ar._=Ef),this}function Uc(){}function Nc(t){return t=Es(t),oi(function(e){return Hr(e,t)})}function Wc(t){return Uo(t)?O(ru(t)):Qr(t)}function Yc(t){return function(e){return null==t?it:sr(t,e)}}function qc(){return[]}function Kc(){return!1}function Xc(){return{}}function $c(){return""}function Gc(){return!0}function Hc(t,e){if(t=Es(t),t<1||t>Dt)return[];var n=Ft,r=Vf(t,Ft);e=Mo(e),t-=Ft;for(var i=j(r,e);++n<t;)e(n);return i}function Jc(t){return wh(t)?v(t,ru):bs(t)?[t]:Ui(Ll(Ps(t)))}function Vc(t){var e=++kf;return Ps(t)+e}function Zc(t){return t&&t.length?Gn(t,Bc,hr):it}function Qc(t,e){return t&&t.length?Gn(t,Mo(e,2),hr):it}function tf(t){return A(t,Bc)}function ef(t,e){return A(t,Mo(e,2))}function nf(t){return t&&t.length?Gn(t,Bc,Yr):it}function rf(t,e){return t&&t.length?Gn(t,Mo(e,2),Yr):it}function of(t){return t&&t.length?I(t,Bc):0}function uf(t,e){return t&&t.length?I(t,Mo(e,2)):0}e=null==e?ar:Sr.defaults(ar.Object(),e,Sr.pick(ar,Hn));var af=e.Array,sf=e.Date,cf=e.Error,ff=e.Function,lf=e.Math,hf=e.Object,pf=e.RegExp,df=e.String,vf=e.TypeError,yf=af.prototype,_f=ff.prototype,gf=hf.prototype,mf=e["__core-js_shared__"],bf=_f.toString,wf=gf.hasOwnProperty,kf=0,xf=function(){var t=/[^.]+$/.exec(mf&&mf.keys&&mf.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Sf=gf.toString,Mf=bf.call(hf),Ef=ar._,Af=pf("^"+bf.call(wf).replace(De,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Of=fr?e.Buffer:it,Tf=e.Symbol,Cf=e.Uint8Array,Pf=Of?Of.allocUnsafe:it,If=$(hf.getPrototypeOf,hf),jf=hf.create,Bf=gf.propertyIsEnumerable,Df=yf.splice,Lf=Tf?Tf.isConcatSpreadable:it,Rf=Tf?Tf.iterator:it,Ff=Tf?Tf.toStringTag:it,zf=function(){try{var t=Oo(hf,"defineProperty");return t({},"",{}),t}catch(t){}}(),Uf=e.clearTimeout!==ar.clearTimeout&&e.clearTimeout,Nf=sf&&sf.now!==ar.Date.now&&sf.now,Wf=e.setTimeout!==ar.setTimeout&&e.setTimeout,Yf=lf.ceil,qf=lf.floor,Kf=hf.getOwnPropertySymbols,Xf=Of?Of.isBuffer:it,$f=e.isFinite,Gf=yf.join,Hf=$(hf.keys,hf),Jf=lf.max,Vf=lf.min,Zf=sf.now,Qf=e.parseInt,tl=lf.random,el=yf.reverse,nl=Oo(e,"DataView"),rl=Oo(e,"Map"),il=Oo(e,"Promise"),ol=Oo(e,"Set"),ul=Oo(e,"WeakMap"),al=Oo(hf,"create"),sl=ul&&new ul,cl={},fl=iu(nl),ll=iu(rl),hl=iu(il),pl=iu(ol),dl=iu(ul),vl=Tf?Tf.prototype:it,yl=vl?vl.valueOf:it,_l=vl?vl.toString:it,gl=function(){function t(){}return function(e){if(!ss(e))return{};if(jf)return jf(e);t.prototype=e;var n=new t;return t.prototype=it,n}}();n.templateSettings={escape:Oe,evaluate:Te,interpolate:Ce,variable:"",imports:{_:n}},n.prototype=r.prototype,n.prototype.constructor=n,i.prototype=gl(r.prototype),i.prototype.constructor=i,b.prototype=gl(r.prototype),b.prototype.constructor=b,nt.prototype.clear=Ye,nt.prototype.delete=en,nt.prototype.get=nn,nt.prototype.has=rn,nt.prototype.set=on,un.prototype.clear=an,un.prototype.delete=sn,un.prototype.get=cn,un.prototype.has=fn,un.prototype.set=ln,hn.prototype.clear=pn,hn.prototype.delete=dn,hn.prototype.get=vn,hn.prototype.has=yn,hn.prototype.set=_n,gn.prototype.add=gn.prototype.push=mn,gn.prototype.has=bn,wn.prototype.clear=kn,wn.prototype.delete=xn,wn.prototype.get=Sn,wn.prototype.has=Mn,wn.prototype.set=En;var ml=Xi(nr),bl=Xi(or,!0),wl=$i(),kl=$i(!0),xl=sl?function(t,e){return sl.set(t,e),t}:Bc,Sl=zf?function(t,e){return zf(t,"toString",{configurable:!0,enumerable:!1,value:Ic(e),writable:!0})}:Bc,Ml=oi,El=Uf||function(t){return ar.clearTimeout(t)},Al=ol&&1/H(new ol([,-0]))[1]==Bt?function(t){return new ol(t)}:Uc,Ol=sl?function(t){return sl.get(t)}:Uc,Tl=Kf?function(t){return null==t?[]:(t=hf(t),h(Kf(t),function(e){return Bf.call(t,e)}))}:qc,Cl=Kf?function(t){for(var e=[];t;)y(e,Tl(t)),t=If(t);return e}:qc,Pl=lr;(nl&&Pl(new nl(new ArrayBuffer(1)))!=le||rl&&Pl(new rl)!=Vt||il&&Pl(il.resolve())!=ee||ol&&Pl(new ol)!=ie||ul&&Pl(new ul)!=se)&&(Pl=function(t){var e=lr(t),n=e==te?t.constructor:it,r=n?iu(n):"";if(r)switch(r){case fl:return le;case ll:return Vt;case hl:return ee;case pl:return ie;case dl:return se}return e});var Il=mf?os:Kc,jl=eu(xl),Bl=Wf||function(t,e){return ar.setTimeout(t,e)},Dl=eu(Sl),Ll=$o(function(t){var e=[];return je.test(t)&&e.push(""),t.replace(Be,function(t,n,r,i){e.push(r?i.replace(qe,"$1"):n||t)}),e}),Rl=oi(function(t,e){return Va(t)?Xn(t,er(e,1,Va,!0)):[]}),Fl=oi(function(t,e){var n=Mu(e);return Va(n)&&(n=it),Va(t)?Xn(t,er(e,1,Va,!0),Mo(n,2)):[]}),zl=oi(function(t,e){var n=Mu(e);return Va(n)&&(n=it),Va(t)?Xn(t,er(e,1,Va,!0),it,n):[]}),Ul=oi(function(t){var e=v(t,Si);return e.length&&e[0]===t[0]?Er(e):[]}),Nl=oi(function(t){var e=Mu(t),n=v(t,Si);return e===Mu(n)?e=it:n.pop(),n.length&&n[0]===t[0]?Er(n,Mo(e,2)):[]}),Wl=oi(function(t){var e=Mu(t),n=v(t,Si);return e="function"==typeof e?e:it,e&&n.pop(),n.length&&n[0]===t[0]?Er(n,it,e):[]}),Yl=oi(Ou),ql=bo(function(t,e){var n=null==t?0:t.length,r=Fn(t,e);return ei(t,v(e,function(t){return Fo(t,n)?+t:t}).sort(Li)),r}),Kl=oi(function(t){return _i(er(t,1,Va,!0))}),Xl=oi(function(t){var e=Mu(t);return Va(e)&&(e=it),_i(er(t,1,Va,!0),Mo(e,2))}),$l=oi(function(t){var e=Mu(t);return e="function"==typeof e?e:it,_i(er(t,1,Va,!0),it,e)}),Gl=oi(function(t,e){return Va(t)?Xn(t,e):[]}),Hl=oi(function(t){return ki(h(t,Va))}),Jl=oi(function(t){var e=Mu(t);return Va(e)&&(e=it),ki(h(t,Va),Mo(e,2))}),Vl=oi(function(t){var e=Mu(t);return e="function"==typeof e?e:it,ki(h(t,Va),it,e)}),Zl=oi(Ju),Ql=oi(function(t){var e=t.length,n=e>1?t[e-1]:it;return n="function"==typeof n?(t.pop(),n):it,Vu(t,n)}),th=bo(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,o=function(e){return Fn(e,t)};return!(e>1||this.__actions__.length)&&r instanceof b&&Fo(n)?(r=r.slice(n,+n+(e?1:0)),r.__actions__.push({func:na,args:[o],thisArg:it}),new i(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(it),t})):this.thru(o)}),eh=qi(function(t,e,n){wf.call(t,n)?++t[n]:Rn(t,n,1)}),nh=Qi(vu),rh=Qi(yu),ih=qi(function(t,e,n){wf.call(t,n)?t[n].push(e):Rn(t,n,[e])}),oh=oi(function(t,e,n){var r=-1,i="function"==typeof e,o=Ja(t)?af(t.length):[];return ml(t,function(t){o[++r]=i?a(e,t,n):Or(t,e,n)}),o}),uh=qi(function(t,e,n){Rn(t,n,e)}),ah=qi(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),sh=oi(function(t,e){if(null==t)return[];var n=e.length;return n>1&&zo(t,e[0],e[1])?e=[]:n>2&&zo(e[0],e[1],e[2])&&(e=[e[0]]),Jr(t,er(e,1),[])}),ch=Nf||function(){return ar.Date.now()},fh=oi(function(t,e,n){var r=_t;if(n.length){var i=G(n,So(fh));r|=kt}return ho(t,r,e,n,i)}),lh=oi(function(t,e,n){var r=_t|gt;if(n.length){var i=G(n,So(lh));r|=kt}return ho(e,r,t,n,i)}),hh=oi(function(t,e){return Kn(t,1,e)}),ph=oi(function(t,e,n){return Kn(t,Os(e)||0,n)});Da.Cache=hn;var dh=Ml(function(t,e){e=1==e.length&&wh(e[0])?v(e[0],D(Mo())):v(er(e,1),D(Mo()));var n=e.length;return oi(function(r){for(var i=-1,o=Vf(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return a(t,this,r)})}),vh=oi(function(t,e){var n=G(e,So(vh));return ho(t,kt,it,e,n)}),yh=oi(function(t,e){var n=G(e,So(yh));return ho(t,xt,it,e,n)}),_h=bo(function(t,e){return ho(t,Mt,it,it,it,e)}),gh=so(hr),mh=so(function(t,e){return t>=e}),bh=Tr(function(){return arguments}())?Tr:function(t){return cs(t)&&wf.call(t,"callee")&&!Bf.call(t,"callee")},wh=af.isArray,kh=pr?D(pr):Cr,xh=Xf||Kc,Sh=dr?D(dr):Pr,Mh=vr?D(vr):Br,Eh=yr?D(yr):Rr,Ah=_r?D(_r):Fr,Oh=gr?D(gr):zr,Th=so(Yr),Ch=so(function(t,e){return t<=e}),Ph=Ki(function(t,e){if(qo(e)||Ja(e))return void Ni(e,qs(e),t);for(var n in e)wf.call(e,n)&&In(t,n,e[n])}),Ih=Ki(function(t,e){Ni(e,Ks(e),t)}),jh=Ki(function(t,e,n,r){Ni(e,Ks(e),t,r)}),Bh=Ki(function(t,e,n,r){Ni(e,qs(e),t,r)}),Dh=bo(Fn),Lh=oi(function(t){return t.push(it,po),a(jh,it,t)}),Rh=oi(function(t){return t.push(it,vo),a(Wh,it,t)}),Fh=no(function(t,e,n){t[e]=n},Ic(Bc)),zh=no(function(t,e,n){wf.call(t,e)?t[e].push(n):t[e]=[n]},Mo),Uh=oi(Or),Nh=Ki(function(t,e,n){$r(t,e,n)}),Wh=Ki(function(t,e,n,r){$r(t,e,n,r)}),Yh=bo(function(t,e){var n={};if(null==t)return n;var r=!1;e=v(e,function(e){return e=Ei(e,t),r||(r=e.length>1),e}),Ni(t,ko(t),n),r&&(n=Un(n,ht|pt|dt,yo));for(var i=e.length;i--;)gi(n,e[i]);return n}),qh=bo(function(t,e){return null==t?{}:Vr(t,e)}),Kh=lo(qs),Xh=lo(Ks),$h=Ji(function(t,e,n){return e=e.toLowerCase(),t+(n?sc(e):e)}),Gh=Ji(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Hh=Ji(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),Jh=Hi("toLowerCase"),Vh=Ji(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Zh=Ji(function(t,e,n){return t+(n?" ":"")+tp(e)}),Qh=Ji(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),tp=Hi("toUpperCase"),ep=oi(function(t,e){try{return a(t,it,e)}catch(t){return rs(t)?t:new cf(t)}}),np=bo(function(t,e){return c(e,function(e){e=ru(e),Rn(t,e,fh(t[e],t))}),t}),rp=to(),ip=to(!0),op=oi(function(t,e){return function(n){return Or(n,t,e)}}),up=oi(function(t,e){return function(n){return Or(t,n,e)}}),ap=io(v),sp=io(l),cp=io(m),fp=ao(),lp=ao(!0),hp=ro(function(t,e){return t+e},0),pp=fo("ceil"),dp=ro(function(t,e){return t/e},1),vp=fo("floor"),yp=ro(function(t,e){return t*e},1),_p=fo("round"),gp=ro(function(t,e){return t-e},0);return n.after=Oa,n.ary=Ta,n.assign=Ph,n.assignIn=Ih,n.assignInWith=jh,n.assignWith=Bh,n.at=Dh,n.before=Ca,n.bind=fh,n.bindAll=np,n.bindKey=lh,n.castArray=Ya,n.chain=ta,n.chunk=au,n.compact=su,n.concat=cu,n.cond=Cc,n.conforms=Pc,n.constant=Ic,n.countBy=eh,n.create=Is,n.curry=Pa,n.curryRight=Ia,n.debounce=ja,n.defaults=Lh,n.defaultsDeep=Rh,n.defer=hh,n.delay=ph,n.difference=Rl,n.differenceBy=Fl,n.differenceWith=zl,n.drop=fu,n.dropRight=lu,n.dropRightWhile=hu,n.dropWhile=pu,n.fill=du,n.filter=la,n.flatMap=ha,n.flatMapDeep=pa,n.flatMapDepth=da,n.flatten=_u,n.flattenDeep=gu,n.flattenDepth=mu,n.flip=Ba,n.flow=rp,n.flowRight=ip,n.fromPairs=bu,n.functions=zs,n.functionsIn=Us,n.groupBy=ih,n.initial=xu,n.intersection=Ul,n.intersectionBy=Nl,n.intersectionWith=Wl,n.invert=Fh,n.invertBy=zh,n.invokeMap=oh,n.iteratee=Dc,n.keyBy=uh,n.keys=qs,n.keysIn=Ks,n.map=ga,n.mapKeys=Xs,n.mapValues=$s,n.matches=Lc,n.matchesProperty=Rc,n.memoize=Da,n.merge=Nh,n.mergeWith=Wh,n.method=op,n.methodOf=up,n.mixin=Fc,n.negate=La,n.nthArg=Nc,n.omit=Yh,n.omitBy=Gs,n.once=Ra,n.orderBy=ma,n.over=ap,n.overArgs=dh,n.overEvery=sp,n.overSome=cp,n.partial=vh,n.partialRight=yh,n.partition=ah,n.pick=qh,n.pickBy=Hs,n.property=Wc,n.propertyOf=Yc,n.pull=Yl,n.pullAll=Ou,n.pullAllBy=Tu,n.pullAllWith=Cu,n.pullAt=ql,n.range=fp,n.rangeRight=lp,n.rearg=_h,n.reject=ka,n.remove=Pu,n.rest=Fa,n.reverse=Iu,n.sampleSize=Sa,n.set=Vs,n.setWith=Zs,n.shuffle=Ma,n.slice=ju,n.sortBy=sh,n.sortedUniq=Uu,n.sortedUniqBy=Nu,n.split=mc,n.spread=za,n.tail=Wu,n.take=Yu,n.takeRight=qu,n.takeRightWhile=Ku,n.takeWhile=Xu,n.tap=ea,n.throttle=Ua,n.thru=na,n.toArray=Ss,n.toPairs=Kh,n.toPairsIn=Xh,n.toPath=Jc,n.toPlainObject=Ts,n.transform=Qs,n.unary=Na,n.union=Kl,n.unionBy=Xl,n.unionWith=$l,n.uniq=$u,n.uniqBy=Gu,n.uniqWith=Hu,n.unset=tc,n.unzip=Ju,n.unzipWith=Vu,n.update=ec,n.updateWith=nc,n.values=rc,n.valuesIn=ic,n.without=Gl,n.words=Tc,n.wrap=Wa,n.xor=Hl,n.xorBy=Jl,n.xorWith=Vl,n.zip=Zl,n.zipObject=Zu,n.zipObjectDeep=Qu,n.zipWith=Ql,n.entries=Kh,n.entriesIn=Xh,n.extend=Ih,n.extendWith=jh,Fc(n,n),n.add=hp,n.attempt=ep,n.camelCase=$h,n.capitalize=sc,n.ceil=pp,n.clamp=oc,n.clone=qa,n.cloneDeep=Xa,n.cloneDeepWith=$a,n.cloneWith=Ka,n.conformsTo=Ga,n.deburr=cc,n.defaultTo=jc,n.divide=dp,n.endsWith=fc,n.eq=Ha,n.escape=lc,n.escapeRegExp=hc,n.every=fa,n.find=nh,n.findIndex=vu,n.findKey=js,n.findLast=rh,n.findLastIndex=yu,n.findLastKey=Bs,n.floor=vp,n.forEach=va,n.forEachRight=ya,n.forIn=Ds,n.forInRight=Ls,n.forOwn=Rs,n.forOwnRight=Fs,n.get=Ns,n.gt=gh,n.gte=mh,n.has=Ws,n.hasIn=Ys,n.head=wu,n.identity=Bc,n.includes=_a,n.indexOf=ku,n.inRange=uc,n.invoke=Uh,n.isArguments=bh,n.isArray=wh,n.isArrayBuffer=kh,n.isArrayLike=Ja,n.isArrayLikeObject=Va,n.isBoolean=Za,n.isBuffer=xh,n.isDate=Sh,n.isElement=Qa,n.isEmpty=ts,n.isEqual=es,n.isEqualWith=ns,n.isError=rs,n.isFinite=is,n.isFunction=os,n.isInteger=us,n.isLength=as,n.isMap=Mh,n.isMatch=fs,n.isMatchWith=ls,n.isNaN=hs,n.isNative=ps,n.isNil=vs,n.isNull=ds,n.isNumber=ys,n.isObject=ss,n.isObjectLike=cs,n.isPlainObject=_s,n.isRegExp=Eh,n.isSafeInteger=gs,n.isSet=Ah,n.isString=ms,n.isSymbol=bs,n.isTypedArray=Oh,n.isUndefined=ws,n.isWeakMap=ks,n.isWeakSet=xs,n.join=Su,n.kebabCase=Gh,n.last=Mu,n.lastIndexOf=Eu,n.lowerCase=Hh,n.lowerFirst=Jh,n.lt=Th,n.lte=Ch,n.max=Zc,n.maxBy=Qc,n.mean=tf,n.meanBy=ef,n.min=nf,n.minBy=rf,n.stubArray=qc,n.stubFalse=Kc,n.stubObject=Xc,n.stubString=$c,n.stubTrue=Gc,n.multiply=yp,n.nth=Au,n.noConflict=zc,n.noop=Uc,n.now=ch,n.pad=pc,n.padEnd=dc,n.padStart=vc,n.parseInt=yc,n.random=ac,n.reduce=ba,n.reduceRight=wa,n.repeat=_c,n.replace=gc,n.result=Js,n.round=_p,n.runInContext=t,n.sample=xa,n.size=Ea,n.snakeCase=Vh,n.some=Aa,n.sortedIndex=Bu,n.sortedIndexBy=Du,n.sortedIndexOf=Lu,n.sortedLastIndex=Ru,n.sortedLastIndexBy=Fu,n.sortedLastIndexOf=zu,n.startCase=Zh,n.startsWith=bc,n.subtract=gp,n.sum=of,n.sumBy=uf,n.template=wc,n.times=Hc,n.toFinite=Ms,n.toInteger=Es,n.toLength=As,n.toLower=kc,n.toNumber=Os,n.toSafeInteger=Cs,n.toString=Ps,n.toUpper=xc,n.trim=Sc,n.trimEnd=Mc,n.trimStart=Ec,n.truncate=Ac,n.unescape=Oc,n.uniqueId=Vc,n.upperCase=Qh,n.upperFirst=tp,n.each=va,n.eachRight=ya,n.first=wu,Fc(n,function(){var t={};return nr(n,function(e,r){wf.call(n.prototype,r)||(t[r]=e)}),t}(),{chain:!1}),n.VERSION=ot,c(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){n[t].placeholder=n}),c(["drop","take"],function(t,e){b.prototype[t]=function(n){n=n===it?1:Jf(Es(n),0);var r=this.__filtered__&&!e?new b(this):this.clone();return r.__filtered__?r.__takeCount__=Vf(n,r.__takeCount__):r.__views__.push({size:Vf(n,Ft),type:t+(r.__dir__<0?"Right":"")}),r},b.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),c(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==Pt||n==jt;b.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Mo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),c(["head","last"],function(t,e){var n="take"+(e?"Right":"");b.prototype[t]=function(){return this[n](1).value()[0]}}),c(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");b.prototype[t]=function(){return this.__filtered__?new b(this):this[n](1)}}),b.prototype.compact=function(){return this.filter(Bc)},b.prototype.find=function(t){return this.filter(t).head()},b.prototype.findLast=function(t){return this.reverse().find(t)},b.prototype.invokeMap=oi(function(t,e){return"function"==typeof t?new b(this):this.map(function(n){return Or(n,t,e)})}),b.prototype.reject=function(t){return this.filter(La(Mo(t)))},b.prototype.slice=function(t,e){t=Es(t);var n=this;return n.__filtered__&&(t>0||e<0)?new b(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==it&&(e=Es(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},b.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},b.prototype.toArray=function(){return this.take(Ft)},nr(b.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),o=/^(?:head|last)$/.test(e),u=n[o?"take"+("last"==e?"Right":""):e],a=o||/^find/.test(e);u&&(n.prototype[e]=function(){var e=this.__wrapped__,s=o?[1]:arguments,c=e instanceof b,f=s[0],l=c||wh(e),h=function(t){var e=u.apply(n,y([t],s));return o&&p?e[0]:e};l&&r&&"function"==typeof f&&1!=f.length&&(c=l=!1);var p=this.__chain__,d=!!this.__actions__.length,v=a&&!p,_=c&&!d;if(!a&&l){e=_?e:new b(this);var g=t.apply(e,s);return g.__actions__.push({func:na,args:[h],thisArg:it}),new i(g,p)}return v&&_?t.apply(this,s):(g=this.thru(h),v?o?g.value()[0]:g.value():g)})}),c(["pop","push","shift","sort","splice","unshift"],function(t){var e=yf[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);n.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var n=this.value();return e.apply(wh(n)?n:[],t)}return this[r](function(n){return e.apply(wh(n)?n:[],t)})}}),nr(b.prototype,function(t,e){var r=n[e];if(r){var i=r.name+"",o=cl[i]||(cl[i]=[]);o.push({name:e,func:r})}}),cl[eo(it,gt).name]=[{name:"wrapper",func:it}],b.prototype.clone=T,b.prototype.reverse=V,b.prototype.value=et,n.prototype.at=th,n.prototype.chain=ra,n.prototype.commit=ia,n.prototype.next=oa,n.prototype.plant=aa,n.prototype.reverse=sa,n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=ca,n.prototype.first=n.prototype.head,Rf&&(n.prototype[Rf]=ua),n},Sr=xr();ar._=Sr,r=function(){return Sr}.call(e,n,e,i),!(r!==it&&(i.exports=r))}).call(this)}).call(e,function(){return this}(),n(72)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(63),v=r(d),y=n(107),_=r(y),g=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.id,u=void 0===i?-1:i,s=r.color,c=void 0===s?"#fff":s,f=r.damping,h=void 0===f?.96:f,p=r.invMass,d=void 0===p?1:p;(0,a.default)(this,e);var y=(0,l.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t));return y.id=0,y.bounce=.5,y.damping=.96,y.kickStrength=5,y.kicking=!1,y.invMass=.5,y.isMe=!1,y.isBall=!1,y.id=u!==-1?u:e.nextDiscId++,y.velocity=new v.default(0,0),y.radius=n,y.color=c,y.damping=h,y.invMass=d,y}return(0,p.default)(e,t),(0,c.default)(e,[{key:"clone",value:function t(){var t=new e(this.position.clone(),this.radius,{id:this.id,color:this.color,damping:this.damping,invMass:this.invMass});return t.id=this.id,t.velocity=this.velocity.clone(),t.isMe=this.isMe,t.isBall=this.isBall,t}},{key:"pack",value:function(){return{id:this.id,pos:this.position.toArray(),velocity:this.velocity.toArray(),radius:this.radius,color:this.color,damping:this.damping,invMass:this.invMass,ball:this.isBall}}},{key:"draw",value:function(t){t.beginPath(),t.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI),t.fillStyle=this.color,t.lineWidth=2,t.strokeStyle=this.kicking?"#fff":"#000",t.fill(),t.closePath(),t.stroke(),this.isMe&&(t.beginPath(),t.arc(this.position.x,this.position.y,this.radius+10,0,2*Math.PI),t.lineWidth=3,t.strokeStyle="rgba(255, 255, 255, 0.2)",t.closePath(),t.stroke())}},{key:"mass",get:function(){return 1/this.invMass}}],[{key:"parse",value:function(t){var n=new e(v.default.fromArray(t.pos),t.radius,{id:t.id,color:t.color,damping:t.damping,invMass:t.invMass});return t.velocity&&(n.velocity=v.default.fromArray(t.velocity)),n.isBall=t.ball,n}}]),e}(_.default);g.nextDiscId=0,e.default=g},function(t,e,n){t.exports={default:n(75),__esModule:!0}},function(t,e,n){n(76),t.exports=n(19).Object.getPrototypeOf},function(t,e,n){var r=n(51),i=n(50);n(77)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(17),i=n(19),o=n(28);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],u={};u[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",u)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(79),o=r(i);e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":(0,o.default)(e))&&"function"!=typeof e?t:e}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(80),o=r(i),u=n(83),a=r(u),s="function"==typeof a.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":typeof t};e.default="function"==typeof a.default&&"symbol"===s(o.default)?function(t){return"undefined"==typeof t?"undefined":s(t)}:function(t){return t&&"function"==typeof a.default&&t.constructor===a.default&&t!==a.default.prototype?"symbol":"undefined"==typeof t?"undefined":s(t)}},function(t,e,n){t.exports={default:n(81),__esModule:!0}},function(t,e,n){n(52),n(6),t.exports=n(82).f("iterator")},function(t,e,n){e.f=n(49)},function(t,e,n){t.exports={default:n(84),__esModule:!0}},function(t,e,n){n(85),n(96),n(97),n(98),t.exports=n(19).Symbol},function(t,e,n){"use strict";var r=n(18),i=n(33),o=n(27),u=n(17),a=n(32),s=n(86).KEY,c=n(28),f=n(44),l=n(48),h=n(45),p=n(49),d=n(82),v=n(87),y=n(88),_=n(89),g=n(92),m=n(24),b=n(11),w=n(30),k=n(31),x=n(35),S=n(93),M=n(95),E=n(23),A=n(37),O=M.f,T=E.f,C=S.f,P=r.Symbol,I=r.JSON,j=I&&I.stringify,B="prototype",D=p("_hidden"),L=p("toPrimitive"),R={}.propertyIsEnumerable,F=f("symbol-registry"),z=f("symbols"),U=f("op-symbols"),N=Object[B],W="function"==typeof P,Y=r.QObject,q=!Y||!Y[B]||!Y[B].findChild,K=o&&c(function(){return 7!=x(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=O(N,e);r&&delete N[e],T(t,e,n),r&&t!==N&&T(N,e,r)}:T,X=function(t){var e=z[t]=x(P[B]);return e._k=t,e},$=W&&"symbol"==typeof P.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof P},G=function(t,e,n){return t===N&&G(U,e,n),m(t),e=w(e,!0),m(n),i(z,e)?(n.enumerable?(i(t,D)&&t[D][e]&&(t[D][e]=!1),n=x(n,{enumerable:k(0,!1)})):(i(t,D)||T(t,D,k(1,{})),t[D][e]=!0),K(t,e,n)):T(t,e,n)},H=function(t,e){m(t);for(var n,r=_(e=b(e)),i=0,o=r.length;o>i;)G(t,n=r[i++],e[n]);return t},J=function(t,e){return void 0===e?x(t):H(x(t),e)},V=function(t){var e=R.call(this,t=w(t,!0));return!(this===N&&i(z,t)&&!i(U,t))&&(!(e||!i(this,t)||!i(z,t)||i(this,D)&&this[D][t])||e)},Z=function(t,e){if(t=b(t),e=w(e,!0),t!==N||!i(z,e)||i(U,e)){var n=O(t,e);return!n||!i(z,e)||i(t,D)&&t[D][e]||(n.enumerable=!0),n}},Q=function(t){for(var e,n=C(b(t)),r=[],o=0;n.length>o;)i(z,e=n[o++])||e==D||e==s||r.push(e);return r},tt=function(t){for(var e,n=t===N,r=C(n?U:b(t)),o=[],u=0;r.length>u;)!i(z,e=r[u++])||n&&!i(N,e)||o.push(z[e]);return o};W||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(n){this===N&&e.call(U,n),i(this,D)&&i(this[D],t)&&(this[D][t]=!1),K(this,t,k(1,n))};return o&&q&&K(N,t,{configurable:!0,set:e}),X(t)},a(P[B],"toString",function(){return this._k}),M.f=Z,E.f=G,n(94).f=S.f=Q,n(91).f=V,n(90).f=tt,o&&!n(16)&&a(N,"propertyIsEnumerable",V,!0),d.f=function(t){return X(p(t))}),u(u.G+u.W+u.F*!W,{Symbol:P});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)p(et[nt++]);for(var et=A(p.store),nt=0;et.length>nt;)v(et[nt++]);u(u.S+u.F*!W,"Symbol",{for:function(t){return i(F,t+="")?F[t]:F[t]=P(t)},keyFor:function(t){if($(t))return y(F,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){q=!0},useSimple:function(){q=!1}}),u(u.S+u.F*!W,"Object",{create:J,defineProperty:G,defineProperties:H,getOwnPropertyDescriptor:Z,getOwnPropertyNames:Q,getOwnPropertySymbols:tt}),I&&u(u.S+u.F*(!W||c(function(){var t=P();return"[null]"!=j([t])||"{}"!=j({a:t})||"{}"!=j(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);return e=r[1],"function"==typeof e&&(n=e),!n&&g(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!$(e))return e}),r[1]=e,j.apply(I,r)}}}),P[B][L]||n(22)(P[B],L,P[B].valueOf),l(P,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,e,n){var r=n(45)("meta"),i=n(25),o=n(33),u=n(23).f,a=0,s=Object.isExtensible||function(){return!0},c=!n(28)(function(){return s(Object.preventExtensions({}))}),f=function(t){u(t,r,{value:{i:"O"+ ++a,w:{}}})},l=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!s(t))return"F";if(!e)return"E";f(t)}return t[r].i},h=function(t,e){if(!o(t,r)){if(!s(t))return!0;if(!e)return!1;f(t)}return t[r].w},p=function(t){return c&&d.NEED&&s(t)&&!o(t,r)&&f(t),t},d=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:h,onFreeze:p}},function(t,e,n){var r=n(18),i=n(19),o=n(16),u=n(82),a=n(23).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:u.f(t)})}},function(t,e,n){var r=n(37),i=n(11);t.exports=function(t,e){for(var n,o=i(t),u=r(o),a=u.length,s=0;a>s;)if(o[n=u[s++]]===e)return n}},function(t,e,n){var r=n(37),i=n(90),o=n(91);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var u,a=n(t),s=o.f,c=0;a.length>c;)s.call(t,u=a[c++])&&e.push(u);return e}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(13);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(11),i=n(94).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?a(t):i(r(t))}},function(t,e,n){var r=n(38),i=n(46).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(91),i=n(31),o=n(11),u=n(30),a=n(33),s=n(26),c=Object.getOwnPropertyDescriptor;e.f=n(27)?c:function(t,e){if(t=o(t),e=u(e,!0),s)try{return c(t,e)}catch(t){}if(a(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e){},function(t,e,n){n(87)("asyncIterator")},function(t,e,n){n(87)("observable")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var i=n(100),o=r(i),u=n(104),a=r(u),s=n(79),c=r(s);e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":(0,c.default)(e)));t.prototype=(0,a.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(o.default?(0,o.default)(t,e):t.__proto__=e)}},function(t,e,n){t.exports={default:n(101),__esModule:!0}},function(t,e,n){n(102),t.exports=n(19).Object.setPrototypeOf},function(t,e,n){var r=n(17);r(r.S,"Object",{setPrototypeOf:n(103).set})},function(t,e,n){var r=n(25),i=n(24),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{r=n(20)(Function.call,n(95).f(Object.prototype,"__proto__").set,2),r(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){t.exports={default:n(105),__esModule:!0}},function(t,e,n){n(106);var r=n(19).Object;t.exports=function(t,e){return r.create(t,e)}},function(t,e,n){var r=n(17);r(r.S,"Object",{create:n(35)})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=function t(e){(0,o.default)(this,t),this.position=e};e.default=u},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=function(){function t(e){var n=this;(0,o.default)(this,t),this.keyCodes={37:"left",38:"up",39:"right",40:"down",32:"kick",88:"kick"},this.keyDown={up:!1,down:!1,left:!1,right:!1,kick:!1},this.handler=e,document.addEventListener("keydown",function(t){
n.setKey(t,!0)}),document.addEventListener("keyup",function(t){n.setKey(t,!1)})}return(0,a.default)(t,[{key:"setKey",value:function(t,e){var n=this.codeToKey(t.keyCode);t.preventDefault(),"undefined"!=typeof this.keyDown[n]&&this.keyDown[n]!==e&&(this.keyDown[n]=e,this.handler(n,e))}},{key:"codeToKey",value:function(t){return this.keyCodes[t]}},{key:"isDown",value:function(t){return this.keyDown[t]}},{key:"isUp",value:function(t){return!this.isDown(t)}}]),t}();e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=n(63),c=(r(s),n(110)),f=r(c),l=n(73),h=r(l),p=n(111),d=r(p),v=n(113),y=r(v),_=function(){function t(e){(0,o.default)(this,t),this.backgrounds=[],this.discs=[],this.goals=[],this.planes=[],this.segments=[],this.teams=e.teams,this.playerPhysics=e.player,this.backgrounds=e.backgrounds.map(function(t){return f.default.parse(t)}),this.discs=e.discs.map(function(t){return h.default.parse(t)}),this.goals=e.goals.map(function(t){return d.default.parse(t)}),this.segments=e.segments.map(function(t){return y.default.parse(t)})}return(0,a.default)(t,[{key:"pack",value:function(){return{backgrounds:this.backgrounds.map(function(t){return t.pack()}),discs:this.discs.map(function(t){return t.pack()}),goals:this.goals.map(function(t){return t.pack()}),segments:this.segments.map(function(t){return t.pack()}),teams:this.teams,player:this.playerPhysics}}},{key:"getTeam",value:function(t){return this.teams.find(function(e){return e.name==t})}}]),t}();e.default=_},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=n(63),c=r(s),f=function(){function t(e,n,r,i){(0,o.default)(this,t),this.loaded=!1,this.pos=e,this.width=n,this.height=r,this.type=i}return(0,a.default)(t,[{key:"load",value:function(){var e=this,n=t.images[this.type];n instanceof HTMLImageElement&&(n.complete&&(this.loaded=!0),n.onload=function(){e.loaded=!0})}},{key:"draw",value:function(e){var n=t.images[this.type];if(n instanceof HTMLImageElement&&this.loaded){var r=e.createPattern(n,"repeat");e.fillStyle=r,e.fillRect(this.pos.x,this.pos.y,this.width,this.height)}}},{key:"pack",value:function(){return{pos:this.pos.toArray(),width:this.width,height:this.height,type:this.type}}}],[{key:"parse",value:function(e){var n=new t(c.default.fromArray(e.pos),e.width,e.height,e.type);return n.load(),n}}]),t}();f.images={grass:null},e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(63),v=r(d),y=n(112),_=r(y),g=function(t){function e(t,n,r){(0,a.default)(this,e);var i=(0,l.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));return i.teamScored=r,i}return(0,p.default)(e,t),(0,c.default)(e,[{key:"clone",value:function(){return new e(this.p0.clone(),this.p1.clone(),this.teamScored)}},{key:"pack",value:function(){return{p0:this.p0.toArray(),p1:this.p1.toArray(),teamScored:this.teamScored}}}],[{key:"parse",value:function(t){return new e(v.default.fromArray(t.p0),v.default.fromArray(t.p1),t.teamScored)}}]),e}(_.default);e.default=g},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=function(){function t(e,n){(0,o.default)(this,t),this.p0=e,this.p1=n}return(0,a.default)(t,[{key:"draw",value:function(t){t.beginPath(),t.moveTo(this.p0.x,this.p0.y),t.lineTo(this.p1.x,this.p1.y),t.lineWidth=3,t.strokeStyle="rgba(255, 255, 255, 0.6)",t.closePath(),t.stroke()}}]),t}();e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(63),v=r(d),y=n(112),_=r(y),g=function(t){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;(0,a.default)(this,e);var i=(0,l.default)(this,(e.__proto__||(0,o.default)(e)).call(this,t,n));return i.bounce=r,i}return(0,p.default)(e,t),(0,c.default)(e,[{key:"clone",value:function(){return new e(this.p0.clone(),this.p1.clone(),this.bounce)}},{key:"pack",value:function(){return{p0:this.p0.toArray(),p1:this.p1.toArray(),bounce:this.bounce}}}],[{key:"parse",value:function(t){return new e(v.default.fromArray(t.p0),v.default.fromArray(t.p1),t.bounce)}}]),e}(_.default);e.default=g},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=n(115),c=(r(s),function(){function t(e,n){(0,o.default)(this,t),this.width=0,this.height=0,this.width=e,this.height=n}return(0,a.default)(t,[{key:"init",value:function(){var t=this.createCanvas(),e=t.getContext("2d");if(null==e)throw new Error;this.canvas=t,this.ctx=e,this.center(),this.parent&&this.render()}},{key:"setParent",value:function(t){this.parent=t,this.canvas&&this.render()}},{key:"render",value:function(){var t=this.parent;this.canvas&&t&&(this.remove(),t.appendChild(this.canvas),this.canvas.focus())}},{key:"remove",value:function(){this.canvas.remove()}},{key:"createCanvas",value:function(){var t=document.createElement("canvas");return t.width=this.width,t.height=this.height,t}},{key:"center",value:function(){this.ctx.translate(this.width/2,this.height/2)}},{key:"setWidth",value:function(t){this.width=t,this.canvas.width=t,this.center()}},{key:"draw",value:function(t){var e,n,r=this,i=[-this.width/2,-this.height/2,this.width,this.height];(e=this.ctx).clearRect.apply(e,i),this.ctx.fillStyle="#718c5a",(n=this.ctx).fillRect.apply(n,i),t.stadium.backgrounds.forEach(function(t){t.draw(r.ctx)}),t.stadium.segments.forEach(function(t){t.draw(r.ctx)}),t.stadium.goals.forEach(function(t){t.draw(r.ctx)}),t.discs.forEach(function(t){t.draw(r.ctx)})}}]),t}());e.default=c},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(57),u=i(o),a=n(58),s=i(a),c=n(71),f=i(c),l=n(63),h=(i(l),n(116)),p=r(h),d=n(109),v=i(d),y=n(73),_=i(y),g=n(119),m=i(g),b=n(113),w=(i(b),function(){function t(){(0,u.default)(this,t),this.discs=[],this.events=[],this.frame=0,this.players=[],this.playing=!1,this.scores={},this.scoreLimit=3,this.timer=0,this.timeLimit=3,this.matchState=t.STATE_KICKOFF,this.matchStateTimer=0}return(0,s.default)(t,[{key:"addPlayers",value:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.players=this.players.concat(e)}},{key:"getPlayerById",value:function(t){return this.players.find(function(e){return e.clientId==t})}},{key:"getTeamPlayers",value:function(t){return this.players.filter(function(e){return e.team==t.name})}},{key:"addDiscs",value:function(t){this.discs=this.discs.concat(t)}},{key:"addDisc",value:function(t){this.discs.push(t)}},{key:"removeDisc",value:function(t){this.discs.splice(this.discs.indexOf(t),1)}},{key:"getPlayerDisc",value:function(t){return this.discs.find(function(e){return e.id==t.discId})}},{key:"clone",value:function e(){var e=new t;return e.frame=this.frame,e.stadium=this.stadium,e.scoreLimit=this.scoreLimit,e.scores=f.default.clone(this.scores),e.timer=this.timer,e.timeLimit=this.timeLimit,e.playing=this.playing,e.matchState=this.matchState,e.matchStateTimer=this.matchStateTimer,e.players=this.players.map(function(t){return t.clone()}),e.discs=this.discs.map(function(t){return t.clone()}),e}},{key:"pack",value:function(){return{frame:this.frame,discs:this.discs.map(function(t){return t.pack()}),events:this.events.map(function(t){return t.pack()}),players:this.players.map(function(t){return t.pack()}),stadium:this.stadium.pack(),scoreLimit:this.scoreLimit,scores:this.scores,timer:this.timer,timeLimit:this.timeLimit,playing:this.playing,matchState:this.matchState,matchStateTimer:this.matchStateTimer}}}],[{key:"parse",value:function(e){var n=new t;return n.frame=e.frame,n.stadium=new v.default(e.stadium),n.scoreLimit=e.scoreLimit,n.scores=e.scores,n.timer=e.timer,n.timeLimit=e.timeLimit,n.playing=e.playing,n.matchState=e.matchState,n.matchStateTimer=e.matchStateTimer,n.players=e.players.map(function(t){return m.default.parse(t)}),n.discs=e.discs.map(function(t){return _.default.parse(t)}),n.events=e.events.map(function(t){var e=p[t.eventType].parse(t.sender,t.data);return e.frame=t.frame,e}),n}},{key:"createFromStadium",value:function(e){var n=new t;return n.stadium=e,n.discs=e.discs.map(function(t){return t.clone()}),e.teams.forEach(function(t){n.scores[t.name]=0}),n}}]),t}());w.STATE_KICKOFF=0,w.STATE_INPLAY=1,w.STATE_GOALSCORED=2,w.STATE_ENDGAME=3,e.default=w},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.StopGame=e.StartGame=e.Keypress=e.ClientAdded=e.ChangeTeam=void 0;var i=n(117),o=r(i),u=n(120),a=r(u),s=n(121),c=r(s),f=n(122),l=r(f),h=n(123),p=r(h);e.ChangeTeam=o.default,e.ClientAdded=a.default,e.Keypress=c.default,e.StartGame=l.default,e.StopGame=p.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(118),v=r(d),y=n(119),_=(r(y),function(t){function e(){var t,n,r,i;(0,a.default)(this,e);for(var u=arguments.length,s=Array(u),c=0;c<u;c++)s[c]=arguments[c];return n=r=(0,l.default)(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(s))),r.type="ChangeTeam",i=n,(0,l.default)(r,i)}return(0,p.default)(e,t),(0,c.default)(e,[{key:"apply",value:function(t,e){var n=t.getPlayerById(this.data.clientId);if(n){var r=t.getPlayerDisc(n);t.stadium.getTeam(this.data.team);if((null===this.data.team||t.stadium.getTeam(this.data.team))&&n.team!==this.data.team){if(n.team=this.data.team,r&&t.removeDisc(r),null===this.data.team)return void(n.discId=null);var i=e.createPlayerDisc(n);i&&(n.discId=i.id,t.addDisc(i))}}}},{key:"getData",value:function(){return this.data}}],[{key:"parse",value:function(t,n){return new e(t,n)}}]),e}(v.default));e.default=_},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=function(){function t(e,n){(0,o.default)(this,t),this.sender=e,this.data=n}return(0,a.default)(t,[{key:"apply",value:function(t,e){}},{key:"getData",value:function(){return""}},{key:"pack",value:function(){return{eventType:this.type,frame:this.frame,sender:this.sender,data:this.getData()}}},{key:"toMessage",value:function(){return{type:"event",event:this.pack()}}}]),t}();e.default=s},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=n(71),c=r(s),f=function(){function t(e,n,r){(0,o.default)(this,t),this.keys={up:!1,down:!1,left:!1,right:!1,kick:!1},this.clientId=e,this.nick=n,this.team=r}return(0,a.default)(t,[{key:"clone",value:function(){var e=new t(this.clientId,this.nick,this.team);return e.discId=this.discId,e.keys=c.default.clone(this.keys),e}},{key:"pack",value:function(){return{clientId:this.clientId,nick:this.nick,team:this.team,keys:this.keys,discId:this.discId}}}],[{key:"parse",value:function(e){var n=new t(e.clientId,e.nick,e.team);return n.discId=e.discId,n.keys=e.keys,n}}]),t}();e.default=f},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(118),v=r(d),y=function(t){function e(){var t,n,r,i;(0,a.default)(this,e);for(var u=arguments.length,s=Array(u),c=0;c<u;c++)s[c]=arguments[c];return n=r=(0,l.default)(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(s))),r.type="ClientAdded",i=n,(0,l.default)(r,i)}return(0,p.default)(e,t),(0,c.default)(e,[{key:"apply",value:function(t,e){var n=e.createPlayer(this.data.clientId,this.data.nick,t.stadium.teams[1]);t.addPlayers(n);var r=e.createPlayerDisc(n);if(!r)throw new Error;n.discId=r.id,t.addDisc(r)}},{key:"getData",value:function(){return this.data}}],[{key:"parse",value:function(t,n){return new e(t,n)}}]),e}(v.default);e.default=y},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(118),v=r(d),y=function(t){function e(){var t,n,r,i;(0,a.default)(this,e);for(var u=arguments.length,s=Array(u),c=0;c<u;c++)s[c]=arguments[c];return n=r=(0,l.default)(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(s))),r.type="Keypress",i=n,(0,l.default)(r,i)}return(0,p.default)(e,t),(0,c.default)(e,[{key:"apply",value:function(t,e){var n=this,r=t.players.find(function(t){return t.clientId==n.data.clientId});if(!r)throw new Error;r.keys[this.data.key]=this.data.state}},{key:"getData",value:function(){return this.data}}],[{key:"parse",value:function(t,n){return new e(t,n)}}]),e}(v.default);e.default=y},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(118),v=r(d),y=function(t){function e(){var t,n,r,i;(0,a.default)(this,e);for(var u=arguments.length,s=Array(u),c=0;c<u;c++)s[c]=arguments[c];return n=r=(0,l.default)(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(s))),r.type="StartGame",i=n,(0,l.default)(r,i)}return(0,p.default)(e,t),(0,c.default)(e,[{key:"apply",value:function(t,e){t.playing||(e.initRenderer(),e.createPlayerDiscs(t),e.kickOffState(t),t.playing=!0,e.eventAggregator.publish(this))}}]),e}(v.default);e.default=y},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(74),o=r(i),u=n(57),a=r(u),s=n(58),c=r(s),f=n(78),l=r(f),h=n(99),p=r(h),d=n(118),v=r(d),y=function(t){function e(){var t,n,r,i;(0,a.default)(this,e);for(var u=arguments.length,s=Array(u),c=0;c<u;c++)s[c]=arguments[c];return n=r=(0,l.default)(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(s))),r.type="StopGame",i=n,(0,l.default)(r,i)}return(0,p.default)(e,t),(0,c.default)(e,[{key:"apply",value:function(t,e){t.playing&&(e.renderer&&e.renderer.remove(),t.playing=!1,t.players.filter(function(t){return t.team}).forEach(function(e){var n=t.getPlayerDisc(e);n&&t.removeDisc(n)}),e.eventAggregator.publish(this))}}]),e}(v.default);e.default=y},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=n(58),a=r(u),s=n(71),c=r(s),f=function(){function t(e){(0,o.default)(this,t),this.maxStatesToRemember=120,this.futureEvents=[],this.states=[],this.engine=e}return(0,a.default)(t,[{key:"advance",value:function(){var t=this.currentState.clone();return t.events=c.default.remove(this.futureEvents,{frame:++t.frame}),this.engine.run(t,this.currentState.events),this.states.unshift(t),this.states.length>this.maxStatesToRemember&&this.states.splice(this.maxStatesToRemember,this.states.length),t}},{key:"fastForward",value:function(t){for(console.log("fastForward",this.currentFrame,t);this.currentFrame<t;)console.log(this.futureEvents,c.default.find(this.futureEvents,{frame:this.currentFrame+1}),this.currentFrame+1),this.advance(),console.log(this.futureEvents)}},{key:"rewind",value:function(t){var e=c.default.findIndex(this.states,{frame:t});this.states.splice(0,e)}},{key:"resetState",value:function(t){var e=this;this.currentState&&t.frame<this.currentFrame&&this.states.forEach(function(t){e.futureEvents=e.futureEvents.concat(t.events)}),this.states.length=0,this.states.unshift(t)}},{key:"clear",value:function(){this.states.length=0,this.futureEvents.length=0}},{key:"addEvent",value:function(t,e){if(!e||e===this.currentFrame)return t.frame=this.currentFrame,void this.currentState.events.push(t);if(e>this.currentFrame)return t.frame=e,void this.futureEvents.push(t);throw new Error("Trying to add event to past frame")}},{key:"findStateFromFrame",value:function(t){return this.states.find(function(e){return e.frame==t})}},{key:"hasFrameInHistory",value:function(t){var e=this.findStateFromFrame(t);return"undefined"!=typeof e}},{key:"currentState",get:function(){return this.states[0]}},{key:"currentFrame",get:function(){return this.currentState.frame}},{key:"oldestFrame",get:function(){return this.states[this.states.length-1].frame}}]),t}();e.default=f},function(t,e){t.exports={name:"classic",teams:[{name:"red",color:"#e56e56",kickOffPos:[-250,0]},{name:"blue",color:"blue",kickOffPos:[250,0]}],player:{acceleration:.1,damping:.96,kickingAcceleration:.07,kickStrength:4,invMass:.5,radius:15},backgrounds:[{pos:[-370,-170],width:740,height:340,type:"grass"}],segments:[{p0:[-370,-170],p1:[-370,-64]},{p0:[-370,64],p1:[-370,170]},{p0:[-370,-64],p1:[-400,-64],bounce:.2},{p0:[-400,-64],p1:[-400,64],bounce:.2},{p0:[-400,64],p1:[-370,64],bounce:.2},{p0:[370,-170],p1:[370,-64]},{p0:[370,64],p1:[370,170]},{p0:[370,-64],p1:[400,-64],bounce:.2},{p0:[400,-64],p1:[400,64],bounce:.2},{p0:[400,64],p1:[370,64],bounce:.2},{p0:[-370,-170],p1:[370,-170]},{p0:[-370,170],p1:[370,170]}],goals:[{p0:[-370,-64],p1:[-370,64],teamScored:"blue"},{p0:[370,-64],p1:[370,64],teamScored:"red"}],discs:[{pos:[0,0],ball:!0,color:"#FFF",damping:.99,invMass:1,radius:10},{pos:[-370,64],color:"#FFCCCC",bounce:.5,radius:8,invMass:0},{pos:[-370,-64],color:"#FFCCCC",bounce:.5,radius:8,invMass:0},{pos:[370,64],color:"#CCCCFF",bounce:.5,radius:8,invMass:0},{pos:[370,-64],color:"#CCCCFF",bounce:.5,radius:8,invMass:0}]}},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(4),u=i(o),a=n(74),s=i(a),c=n(57),f=i(c),l=n(58),h=i(l),p=n(78),d=i(p),v=n(99),y=i(v),_=n(127),g=i(_),m=n(139),b=i(m),w=n(116),k=r(w),x=n(120),S=i(x),M=function(t){function e(t){(0,f.default)(this,e);var n=(0,d.default)(this,(e.__proto__||(0,s.default)(e)).call(this));return n.clients=[],n.nextClientId=0,n.nextSync=null,n.syncInterval=100,n.game=t,t.network=n,n.peer=new g.default("host",{host:"localhost",path:"/p2p"}),n.peer.on("connection",n.handleConnection.bind(n)),n}return(0,y.default)(e,t),(0,h.default)(e,[{key:"handleConnection",value:function(t){var e=this;t.on("open",function(){var n=new A(e.nextClientId++,t,e.game);t.client=n,e.clients.push(n);var r=new S.default(e.game.myId,{clientId:n.id,nick:"sock"});e.game.simulator.addEvent(r),t.send({type:"init",id:n.id,state:e.game.simulator.currentState.pack()}),e.sendMsg(r.toMessage(),n)})}},{key:"sendMsg",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=(0,u.default)(this.clients);!(n=(o=a.next()).done);n=!0){var s=o.value;e&&s===e||s.conn.send(t)}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}}},{key:"sendSync",value:function(){if(this.game.playing){var t={type:"sync",state:this.game.simulator.currentState.pack()};this.sendMsg(t)}}}]),e}(b.default);e.default=M;var E={event:function t(e){var t=k[e.event.eventType].parse(e.event.sender,e.event.data);if(t.frame=e.event.frame,t instanceof k.Keypress&&(t.data.clientId=this.id),t.frame>=this.game.simulator.currentFrame)this.game.simulator.addEvent(t,t.frame);else if(this.game.simulator.hasFrameInHistory(t.frame)){var n=this.game.simulator.currentState.frame;this.game.stopLoop(),this.game.simulator.rewind(t.frame),this.game.simulator.addEvent(t),this.game.simulator.fastForward(n),this.game.startLoop()}}},A=function(){function t(e,n,r){(0,f.default)(this,t),this.id=e,this.conn=n,this.game=r,n.on("data",this.handleMsg.bind(this))}return(0,h.default)(t,[{key:"handleMsg",value:function(t){if(!E[t.type]||"function"!=typeof E[t.type])throw new Error("Invalid msg type recieved: "+t.type);E[t.type].call(this,t)}}]),t}()},function(t,e,n){function r(t,e){return this instanceof r?(o.call(this),t&&t.constructor==Object?(e=t,t=void 0):t&&(t=t.toString()),e=i.extend({debug:0,host:i.CLOUD_HOST,port:i.CLOUD_PORT,key:"peerjs",path:"/",token:i.randomToken(),config:i.defaultConfig},e),this.options=e,"/"===e.host&&(e.host=window.location.hostname),"/"!==e.path[0]&&(e.path="/"+e.path),"/"!==e.path[e.path.length-1]&&(e.path+="/"),void 0===e.secure&&e.host!==i.CLOUD_HOST&&(e.secure=i.isSecure()),e.logFunction&&i.setLogFunction(e.logFunction),i.setLogLevel(e.debug),i.supports.audioVideo||i.supports.data?i.validateId(t)?i.validateKey(e.key)?e.secure&&"0.peerjs.com"===e.host?void this._delayedAbort("ssl-unavailable","The cloud server currently does not support HTTPS. Please run your own PeerServer to use HTTPS."):(this.destroyed=!1,this.disconnected=!1,this.open=!1,this.connections={},this._lostMessages={},this._initializeServerConnection(),void(t?this._initialize(t):this._retrieveId())):void this._delayedAbort("invalid-key",'API KEY "'+e.key+'" is invalid'):void this._delayedAbort("invalid-id",'ID "'+t+'" is invalid'):void this._delayedAbort("browser-incompatible","The current browser does not support WebRTC")):new r(t,e)}var i=n(128),o=n(132),u=n(133),a=n(134),s=n(136);i.inherits(r,o),r.prototype._initializeServerConnection=function(){var t=this;this.socket=new u(this.options.secure,this.options.host,this.options.port,this.options.path,this.options.key),this.socket.on("message",function(e){t._handleMessage(e)}),this.socket.on("error",function(e){t._abort("socket-error",e)}),this.socket.on("disconnected",function(){t.disconnected||(t.emitError("network","Lost connection to server."),t.disconnect())}),this.socket.on("close",function(){t.disconnected||t._abort("socket-closed","Underlying socket is already closed.")})},r.prototype._retrieveId=function(t){var e=this,n=new XMLHttpRequest,r=this.options.secure?"https://":"http://",o=r+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/id",u="?ts="+(new Date).getTime()+Math.random();o+=u,n.open("get",o,!0),n.onerror=function(t){i.error("Error retrieving ID",t);var n="";"/"===e.options.path&&e.options.host!==i.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),e._abort("server-error","Could not get an ID from the server."+n)},n.onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?void n.onerror():void e._initialize(n.responseText)},n.send(null)},r.prototype._initialize=function(t){this.id=t,this.socket.start(this.id,this.options.token)},r.prototype._handleMessage=function(t){var e,n=t.type,r=t.payload,o=t.src;switch(n){case"OPEN":this.emit("open",this.id),this.open=!0;break;case"ERROR":this._abort("server-error",r.msg);break;case"ID-TAKEN":this._abort("unavailable-id","ID `"+this.id+"` is taken");break;case"INVALID-KEY":this._abort("invalid-key",'API KEY "'+this.options.key+'" is invalid');break;case"LEAVE":i.log("Received leave message from",o),this._cleanupPeer(o);break;case"EXPIRE":this.emitError("peer-unavailable","Could not connect to peer "+o);break;case"OFFER":var u=r.connectionId;if(e=this.getConnection(o,u))i.warn("Offer received for existing Connection ID:",u);else{if("media"===r.type)e=new a(o,this,{connectionId:u,_payload:r,metadata:r.metadata}),this._addConnection(o,e),this.emit("call",e);else{if("data"!==r.type)return void i.warn("Received malformed connection type:",r.type);e=new s(o,this,{connectionId:u,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable}),this._addConnection(o,e),this.emit("connection",e)}for(var c=this._getMessages(u),f=0,l=c.length;f<l;f+=1)e.handleMessage(c[f])}break;default:if(!r)return void i.warn("You received a malformed message from "+o+" of type "+n);var h=r.connectionId;e=this.getConnection(o,h),e&&e.pc?e.handleMessage(t):h?this._storeMessage(h,t):i.warn("You received an unrecognized message:",t)}},r.prototype._storeMessage=function(t,e){this._lostMessages[t]||(this._lostMessages[t]=[]),this._lostMessages[t].push(e)},r.prototype._getMessages=function(t){var e=this._lostMessages[t];return e?(delete this._lostMessages[t],e):[]},r.prototype.connect=function(t,e){if(this.disconnected)return i.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");var n=new s(t,this,e);return this._addConnection(t,n),n},r.prototype.call=function(t,e,n){if(this.disconnected)return i.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");if(!e)return void i.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");n=n||{},n._stream=e;var r=new a(t,this,n);return this._addConnection(t,r),r},r.prototype._addConnection=function(t,e){this.connections[t]||(this.connections[t]=[]),this.connections[t].push(e)},r.prototype.getConnection=function(t,e){var n=this.connections[t];if(!n)return null;for(var r=0,i=n.length;r<i;r++)if(n[r].id===e)return n[r];return null},r.prototype._delayedAbort=function(t,e){var n=this;i.setZeroTimeout(function(){n._abort(t,e)})},r.prototype._abort=function(t,e){i.error("Aborting!"),this._lastServerId?this.disconnect():this.destroy(),this.emitError(t,e)},r.prototype.emitError=function(t,e){i.error("Error:",e),"string"==typeof e&&(e=new Error(e)),e.type=t,this.emit("error",e)},r.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this.destroyed=!0)},r.prototype._cleanup=function(){if(this.connections)for(var t=Object.keys(this.connections),e=0,n=t.length;e<n;e++)this._cleanupPeer(t[e]);this.emit("close")},r.prototype._cleanupPeer=function(t){for(var e=this.connections[t],n=0,r=e.length;n<r;n+=1)e[n].close()},r.prototype.disconnect=function(){var t=this;i.setZeroTimeout(function(){t.disconnected||(t.disconnected=!0,t.open=!1,t.socket&&t.socket.close(),t.emit("disconnected",t.id),t._lastServerId=t.id,t.id=null)})},r.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)i.log("Attempting reconnection to server with ID "+this._lastServerId),this.disconnected=!1,this._initializeServerConnection(),this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");i.error("In a hurry? We're still trying to make the initial connection!")}},r.prototype.listAllPeers=function(t){t=t||function(){};var e=this,n=new XMLHttpRequest,r=this.options.secure?"https://":"http://",o=r+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/peers",u="?ts="+(new Date).getTime()+Math.random();o+=u,n.open("get",o,!0),n.onerror=function(n){e._abort("server-error","Could not get peers from the server."),t([])},n.onreadystatechange=function(){if(4===n.readyState){if(401===n.status){var r="";throw r=e.options.host!==i.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",t([]),new Error("It doesn't look like you have permission to list peers IDs. "+r)}t(200!==n.status?[]:JSON.parse(n.responseText))}},n.send(null)},t.exports=r},function(t,e,n){var r={iceServers:[{url:"stun:stun.l.google.com:19302"}]},i=1,o=n(129),u=n(131).RTCPeerConnection,a={noop:function(){},CLOUD_HOST:"0.peerjs.com",CLOUD_PORT:9e3,chunkedBrowsers:{Chrome:1},chunkedMTU:16300,logLevel:0,setLogLevel:function(t){var e=parseInt(t,10);isNaN(parseInt(t,10))?a.logLevel=t?3:0:a.logLevel=e,a.log=a.warn=a.error=a.noop,a.logLevel>0&&(a.error=a._printWith("ERROR")),a.logLevel>1&&(a.warn=a._printWith("WARNING")),a.logLevel>2&&(a.log=a._print)},setLogFunction:function(t){t.constructor!==Function?a.warn("The log function you passed in is not a function. Defaulting to regular logs."):a._print=t},_printWith:function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t),a._print.apply(a,e)}},_print:function(){var t=!1,e=Array.prototype.slice.call(arguments);e.unshift("PeerJS: ");for(var n=0,r=e.length;n<r;n++)e[n]instanceof Error&&(e[n]="("+e[n].name+") "+e[n].message,t=!0);t?console.error.apply(console,e):console.log.apply(console,e)},defaultConfig:r,browser:function(){return window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported"}(),supports:function(){if("undefined"==typeof u)return{};var t,e,n=!0,i=!0,o=!1,s=!1,c=!!window.webkitRTCPeerConnection;try{t=new u(r,{optional:[{RtpDataChannels:!0}]})}catch(t){n=!1,i=!1}if(n)try{e=t.createDataChannel("_PEERJSTEST")}catch(t){n=!1}if(n){try{e.binaryType="blob",o=!0}catch(t){}var f=new u(r,{});try{var l=f.createDataChannel("_PEERJSRELIABLETEST",{});s=l.reliable}catch(t){}f.close()}if(i&&(i=!!t.addStream),!c&&n){var h=new u(r,{optional:[{RtpDataChannels:!0}]});h.onnegotiationneeded=function(){c=!0,a&&a.supports&&(a.supports.onnegotiationneeded=!0)},h.createDataChannel("_PEERJSNEGOTIATIONTEST"),setTimeout(function(){h.close()},1e3)}return t&&t.close(),{audioVideo:i,data:n,binaryBlob:o,binary:s,reliable:s,sctp:s,onnegotiationneeded:c}}(),validateId:function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(t)},validateKey:function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(t)},debug:!1,inherits:function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},extend:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},pack:o.pack,unpack:o.unpack,log:function(){if(a.debug){var t=!1,e=Array.prototype.slice.call(arguments);e.unshift("PeerJS: ");for(var n=0,r=e.length;n<r;n++)e[n]instanceof Error&&(e[n]="("+e[n].name+") "+e[n].message,t=!0);t?console.error.apply(console,e):console.log.apply(console,e)}},setZeroTimeout:function(t){function e(e){r.push(e),t.postMessage(i,"*")}function n(e){e.source==t&&e.data==i&&(e.stopPropagation&&e.stopPropagation(),r.length&&r.shift()())}var r=[],i="zero-timeout-message";return t.addEventListener?t.addEventListener("message",n,!0):t.attachEvent&&t.attachEvent("onmessage",n),e}(window),chunk:function(t){for(var e=[],n=t.size,r=index=0,o=Math.ceil(n/a.chunkedMTU);r<n;){var u=Math.min(n,r+a.chunkedMTU),s=t.slice(r,u),c={__peerData:i,n:index,data:s,total:o};e.push(c),r=u,index+=1}return i+=1,e},blobToArrayBuffer:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsArrayBuffer(t)},blobToBinaryString:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsBinaryString(t)},binaryStringToArrayBuffer:function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer},randomToken:function(){return Math.random().toString(36).substr(2)},isSecure:function(){return"https:"===location.protocol;
}};t.exports=a},function(t,e,n){function r(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function i(){this.bufferBuilder=new a}function o(t){var e=t.charCodeAt(0);return e<=2047?"00":e<=65535?"000":e<=2097151?"0000":e<=67108863?"00000":"000000"}function u(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,o).length}var a=n(130).BufferBuilder,s=n(130).binaryFeatures,c={unpack:function(t){var e=new r(t);return e.unpack()},pack:function(t){var e=new i;e.pack(t);var n=e.getBuffer();return n}};t.exports=c,r.prototype.unpack=function(){var t=this.unpack_uint8();if(t<128){var e=t;return e}if((224^t)<32){var n=(224^t)-32;return n}var r;if((r=160^t)<=15)return this.unpack_raw(r);if((r=176^t)<=15)return this.unpack_string(r);if((r=144^t)<=15)return this.unpack_array(r);if((r=128^t)<=15)return this.unpack_map(r);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return r=this.unpack_uint16(),this.unpack_string(r);case 217:return r=this.unpack_uint32(),this.unpack_string(r);case 218:return r=this.unpack_uint16(),this.unpack_raw(r);case 219:return r=this.unpack_uint32(),this.unpack_raw(r);case 220:return r=this.unpack_uint16(),this.unpack_array(r);case 221:return r=this.unpack_uint32(),this.unpack_array(r);case 222:return r=this.unpack_uint16(),this.unpack_map(r);case 223:return r=this.unpack_uint32(),this.unpack_map(r)}},r.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t},r.prototype.unpack_uint16=function(){var t=this.read(2),e=256*(255&t[0])+(255&t[1]);return this.index+=2,e},r.prototype.unpack_uint32=function(){var t=this.read(4),e=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,e},r.prototype.unpack_uint64=function(){var t=this.read(8),e=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,e},r.prototype.unpack_int8=function(){var t=this.unpack_uint8();return t<128?t:t-256},r.prototype.unpack_int16=function(){var t=this.unpack_uint16();return t<32768?t:t-65536},r.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)},r.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)},r.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e},r.prototype.unpack_string=function(t){for(var e,n,r=this.read(t),i=0,o="";i<t;)e=r[i],e<128?(o+=String.fromCharCode(e),i++):(192^e)<32?(n=(192^e)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&e)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=t,o},r.prototype.unpack_array=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=this.unpack();return e},r.prototype.unpack_map=function(t){for(var e={},n=0;n<t;n++){var r=this.unpack(),i=this.unpack();e[r]=i}return e},r.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=t>>31,n=(t>>23&255)-127,r=8388607&t|8388608;return(0==e?1:-1)*r*Math.pow(2,n-23)},r.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),n=t>>31,r=(t>>20&2047)-1023,i=1048575&t|1048576,o=i*Math.pow(2,r-20)+e*Math.pow(2,r-52);return(0==n?1:-1)*o},r.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")},i.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},i.prototype.pack=function(t){var e=typeof t;if("string"==e)this.pack_string(t);else if("number"==e)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"==e)t===!0?this.bufferBuilder.append(195):t===!1&&this.bufferBuilder.append(194);else if("undefined"==e)this.bufferBuilder.append(192);else{if("object"!=e)throw new Error('Type "'+e+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var n=t.constructor;if(n==Array)this.pack_array(t);else if(n==Blob||n==File)this.pack_bin(t);else if(n==ArrayBuffer)s.useArrayBufferView?this.pack_bin(new Uint8Array(t)):this.pack_bin(t);else if("BYTES_PER_ELEMENT"in t)s.useArrayBufferView?this.pack_bin(new Uint8Array(t.buffer)):this.pack_bin(t.buffer);else if(n==Object)this.pack_object(t);else if(n==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},i.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(e<=15)this.pack_uint8(160+e);else if(e<=65535)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(e)}this.bufferBuilder.append(t)},i.prototype.pack_string=function(t){var e=u(t);if(e<=15)this.pack_uint8(176+e);else if(e<=65535)this.bufferBuilder.append(216),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(e)}this.bufferBuilder.append(t)},i.prototype.pack_array=function(t){var e=t.length;if(e<=15)this.pack_uint8(144+e);else if(e<=65535)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(e<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(e)}for(var n=0;n<e;n++)this.pack(t[n])},i.prototype.pack_integer=function(t){if(-32<=t&&t<=127)this.bufferBuilder.append(255&t);else if(0<=t&&t<=255)this.bufferBuilder.append(204),this.pack_uint8(t);else if(-128<=t&&t<=127)this.bufferBuilder.append(208),this.pack_int8(t);else if(0<=t&&t<=65535)this.bufferBuilder.append(205),this.pack_uint16(t);else if(-32768<=t&&t<=32767)this.bufferBuilder.append(209),this.pack_int16(t);else if(0<=t&&t<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(t);else if(-2147483648<=t&&t<=2147483647)this.bufferBuilder.append(210),this.pack_int32(t);else if(-0x8000000000000000<=t&&t<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(0<=t&&t<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(t)}},i.prototype.pack_double=function(t){var e=0;t<0&&(e=1,t=-t);var n=Math.floor(Math.log(t)/Math.LN2),r=t/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),u=e<<31|n+1023<<20|i/o&1048575,a=i%o;this.bufferBuilder.append(203),this.pack_int32(u),this.pack_int32(a)},i.prototype.pack_object=function(t){var e=Object.keys(t),n=e.length;if(n<=15)this.pack_uint8(128+n);else if(n<=65535)this.bufferBuilder.append(222),this.pack_uint16(n);else{if(!(n<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(n)}for(var r in t)t.hasOwnProperty(r)&&(this.pack(r),this.pack(t[r]))},i.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)},i.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(255&t)},i.prototype.pack_uint32=function(t){var e=4294967295&t;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},i.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},i.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)},i.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8),this.bufferBuilder.append(255&t)},i.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},i.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},function(t,e){function n(){this._pieces=[],this._parts=[]}var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(t){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(t){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),n.prototype.append=function(t){"number"==typeof t?this._pieces.push(t):(this.flush(),this._parts.push(t))},n.prototype.flush=function(){if(this._pieces.length>0){var t=new Uint8Array(this._pieces);r.useArrayBufferView||(t=t.buffer),this._parts.push(t),this._pieces=[]}},n.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var t=new i,e=0,n=this._parts.length;e<n;e++)t.append(this._parts[e]);return t.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=n},function(t,e){t.exports.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,t.exports.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t.exports.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate},function(t,e){"use strict";function n(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){}r.prototype._events=void 0,r.prototype.listeners=function(t){if(!this._events||!this._events[t])return[];if(this._events[t].fn)return[this._events[t].fn];for(var e=0,n=this._events[t].length,r=new Array(n);e<n;e++)r[e]=this._events[t][e].fn;return r},r.prototype.emit=function(t,e,n,r,i,o){if(!this._events||!this._events[t])return!1;var u,a,s=this._events[t],c=arguments.length;if("function"==typeof s.fn){switch(s.once&&this.removeListener(t,s.fn,!0),c){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,n),!0;case 4:return s.fn.call(s.context,e,n,r),!0;case 5:return s.fn.call(s.context,e,n,r,i),!0;case 6:return s.fn.call(s.context,e,n,r,i,o),!0}for(a=1,u=new Array(c-1);a<c;a++)u[a-1]=arguments[a];s.fn.apply(s.context,u)}else{var f,l=s.length;for(a=0;a<l;a++)switch(s[a].once&&this.removeListener(t,s[a].fn,!0),c){case 1:s[a].fn.call(s[a].context);break;case 2:s[a].fn.call(s[a].context,e);break;case 3:s[a].fn.call(s[a].context,e,n);break;default:if(!u)for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];s[a].fn.apply(s[a].context,u)}}return!0},r.prototype.on=function(t,e,r){var i=new n(e,r||this);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],i]:this._events[t].push(i):this._events[t]=i,this},r.prototype.once=function(t,e,r){var i=new n(e,r||this,!0);return this._events||(this._events={}),this._events[t]?this._events[t].fn?this._events[t]=[this._events[t],i]:this._events[t].push(i):this._events[t]=i,this},r.prototype.removeListener=function(t,e,n){if(!this._events||!this._events[t])return this;var r=this._events[t],i=[];if(e&&(r.fn&&(r.fn!==e||n&&!r.once)&&i.push(r),!r.fn))for(var o=0,u=r.length;o<u;o++)(r[o].fn!==e||n&&!r[o].once)&&i.push(r[o]);return i.length?this._events[t]=1===i.length?i[0]:i:delete this._events[t],this},r.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[t]:this._events={},this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.EventEmitter=r,r.EventEmitter2=r,r.EventEmitter3=r,t.exports=r},function(t,e,n){function r(t,e,n,i,u){if(!(this instanceof r))return new r(t,e,n,i,u);o.call(this),this.disconnected=!1,this._queue=[];var a=t?"https://":"http://",s=t?"wss://":"ws://";this._httpUrl=a+e+":"+n+i+u,this._wsUrl=s+e+":"+n+i+"peerjs?key="+u}var i=n(128),o=n(132);i.inherits(r,o),r.prototype.start=function(t,e){this.id=t,this._httpUrl+="/"+t+"/"+e,this._wsUrl+="&id="+t+"&token="+e,this._startXhrStream(),this._startWebSocket()},r.prototype._startWebSocket=function(t){var e=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(t){try{var n=JSON.parse(t.data)}catch(e){return void i.log("Invalid server message",t.data)}e.emit("message",n)},this._socket.onclose=function(t){i.log("Socket closed."),e.disconnected=!0,e.emit("disconnected")},this._socket.onopen=function(){e._timeout&&(clearTimeout(e._timeout),setTimeout(function(){e._http.abort(),e._http=null},5e3)),e._sendQueuedMessages(),i.log("Socket open")})},r.prototype._startXhrStream=function(t){try{var e=this;this._http=new XMLHttpRequest,this._http._index=1,this._http._streamIndex=t||0,this._http.open("post",this._httpUrl+"/id?i="+this._http._streamIndex,!0),this._http.onerror=function(){clearTimeout(e._timeout),e.emit("disconnected")},this._http.onreadystatechange=function(){2==this.readyState&&this.old?(this.old.abort(),delete this.old):this.readyState>2&&200===this.status&&this.responseText&&e._handleStream(this)},this._http.send(null),this._setHTTPTimeout()}catch(t){i.log("XMLHttpRequest not available; defaulting to WebSockets")}},r.prototype._handleStream=function(t){var e=t.responseText.split("\n");if(t._buffer)for(;t._buffer.length>0;){var n=t._buffer.shift(),r=e[n];try{r=JSON.parse(r)}catch(e){t._buffer.shift(n);break}this.emit("message",r)}var o=e[t._index];if(o)if(t._index+=1,t._index===e.length)t._buffer||(t._buffer=[]),t._buffer.push(t._index-1);else{try{o=JSON.parse(o)}catch(t){return void i.log("Invalid server message",o)}this.emit("message",o)}},r.prototype._setHTTPTimeout=function(){var t=this;this._timeout=setTimeout(function(){var e=t._http;t._wsOpen()?e.abort():(t._startXhrStream(e._streamIndex+1),t._http.old=e)},25e3)},r.prototype._wsOpen=function(){return this._socket&&1==this._socket.readyState},r.prototype._sendQueuedMessages=function(){for(var t=0,e=this._queue.length;t<e;t+=1)this.send(this._queue[t])},r.prototype.send=function(t){if(!this.disconnected){if(!this.id)return void this._queue.push(t);if(!t.type)return void this.emit("error","Invalid message");var e=JSON.stringify(t);if(this._wsOpen())this._socket.send(e);else{var n=new XMLHttpRequest,r=this._httpUrl+"/"+t.type.toLowerCase();n.open("post",r,!0),n.setRequestHeader("Content-Type","application/json"),n.send(e)}}},r.prototype.close=function(){!this.disconnected&&this._wsOpen()&&(this._socket.close(),this.disconnected=!0)},t.exports=r},function(t,e,n){function r(t,e,n){return this instanceof r?(o.call(this),this.options=i.extend({},n),this.open=!1,this.type="media",this.peer=t,this.provider=e,this.metadata=this.options.metadata,this.localStream=this.options._stream,this.id=this.options.connectionId||r._idPrefix+i.randomToken(),void(this.localStream&&u.startConnection(this,{_stream:this.localStream,originator:!0}))):new r(t,e,n)}var i=n(128),o=n(132),u=n(135);i.inherits(r,o),r._idPrefix="mc_",r.prototype.addStream=function(t){i.log("Receiving stream",t),this.remoteStream=t,this.emit("stream",t)},r.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case"ANSWER":u.handleSDP(t.type,this,e.sdp),this.open=!0;break;case"CANDIDATE":u.handleCandidate(this,e.candidate);break;default:i.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},r.prototype.answer=function(t){if(this.localStream)return void i.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");this.options._payload._stream=t,this.localStream=t,u.startConnection(this,this.options._payload);for(var e=this.provider._getMessages(this.id),n=0,r=e.length;n<r;n+=1)this.handleMessage(e[n]);this.open=!0},r.prototype.close=function(){this.open&&(this.open=!1,u.cleanup(this),this.emit("close"))},t.exports=r},function(t,e,n){var r=n(128),i=n(131).RTCPeerConnection,o=n(131).RTCSessionDescription,u=n(131).RTCIceCandidate,a={pcs:{data:{},media:{}},queue:[]};a._idPrefix="pc_",a.startConnection=function(t,e){var n=a._getPeerConnection(t,e);if("media"===t.type&&e._stream&&n.addStream(e._stream),t.pc=t.peerConnection=n,e.originator){if("data"===t.type){var i={};r.supports.sctp||(i={reliable:e.reliable});var o=n.createDataChannel(t.label,i);t.initialize(o)}r.supports.onnegotiationneeded||a._makeOffer(t)}else a.handleSDP("OFFER",t,e.sdp)},a._getPeerConnection=function(t,e){a.pcs[t.type]||r.error(t.type+" is not a valid connection type. Maybe you overrode the `type` property somewhere."),a.pcs[t.type][t.peer]||(a.pcs[t.type][t.peer]={});var n;a.pcs[t.type][t.peer];return e.pc&&(n=a.pcs[t.type][t.peer][e.pc]),n&&"stable"===n.signalingState||(n=a._startPeerConnection(t)),n},a._startPeerConnection=function(t){r.log("Creating RTCPeerConnection.");var e=a._idPrefix+r.randomToken(),n={};"data"!==t.type||r.supports.sctp?"media"===t.type&&(n={optional:[{DtlsSrtpKeyAgreement:!0}]}):n={optional:[{RtpDataChannels:!0}]};var o=new i(t.provider.options.config,n);return a.pcs[t.type][t.peer][e]=o,a._setupListeners(t,o,e),o},a._setupListeners=function(t,e,n){var i=t.peer,o=t.id,u=t.provider;r.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&(r.log("Received ICE candidates for:",t.peer),u.socket.send({type:"CANDIDATE",payload:{candidate:e.candidate,type:t.type,connectionId:t.id},dst:i}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"disconnected":case"failed":r.log("iceConnectionState is disconnected, closing connections to "+i),t.close();break;case"completed":e.onicecandidate=r.noop}},e.onicechange=e.oniceconnectionstatechange,r.log("Listening for `negotiationneeded`"),e.onnegotiationneeded=function(){r.log("`negotiationneeded` triggered"),"stable"==e.signalingState?a._makeOffer(t):r.log("onnegotiationneeded triggered when not stable. Is another connection being established?")},r.log("Listening for data channel"),e.ondatachannel=function(t){r.log("Received data channel");var e=t.channel,n=u.getConnection(i,o);n.initialize(e)},r.log("Listening for remote stream"),e.onaddstream=function(t){r.log("Received remote stream");var e=t.stream,n=u.getConnection(i,o);"media"===n.type&&n.addStream(e)}},a.cleanup=function(t){r.log("Cleaning up PeerConnection to "+t.peer);var e=t.pc;!e||"closed"===e.readyState&&"closed"===e.signalingState||(e.close(),t.pc=null)},a._makeOffer=function(t){var e=t.pc;e.createOffer(function(n){r.log("Created offer."),!r.supports.sctp&&"data"===t.type&&t.reliable&&(n.sdp=Reliable.higherBandwidthSDP(n.sdp)),e.setLocalDescription(n,function(){r.log("Set localDescription: offer","for:",t.peer),t.provider.socket.send({type:"OFFER",payload:{sdp:n,type:t.type,label:t.label,connectionId:t.id,reliable:t.reliable,serialization:t.serialization,metadata:t.metadata,browser:r.browser},dst:t.peer})},function(e){t.provider.emitError("webrtc",e),r.log("Failed to setLocalDescription, ",e)})},function(e){t.provider.emitError("webrtc",e),r.log("Failed to createOffer, ",e)},t.options.constraints)},a._makeAnswer=function(t){var e=t.pc;e.createAnswer(function(n){r.log("Created answer."),!r.supports.sctp&&"data"===t.type&&t.reliable&&(n.sdp=Reliable.higherBandwidthSDP(n.sdp)),e.setLocalDescription(n,function(){r.log("Set localDescription: answer","for:",t.peer),t.provider.socket.send({type:"ANSWER",payload:{sdp:n,type:t.type,connectionId:t.id,browser:r.browser},dst:t.peer})},function(e){t.provider.emitError("webrtc",e),r.log("Failed to setLocalDescription, ",e)})},function(e){t.provider.emitError("webrtc",e),r.log("Failed to create answer, ",e)})},a.handleSDP=function(t,e,n){n=new o(n);var i=e.pc;r.log("Setting remote description",n),i.setRemoteDescription(n,function(){r.log("Set remoteDescription:",t,"for:",e.peer),"OFFER"===t&&a._makeAnswer(e)},function(t){e.provider.emitError("webrtc",t),r.log("Failed to setRemoteDescription, ",t)})},a.handleCandidate=function(t,e){var n=e.candidate,i=e.sdpMLineIndex;t.pc.addIceCandidate(new u({sdpMLineIndex:i,candidate:n})),r.log("Added ICE candidate for:",t.peer)},t.exports=a},function(t,e,n){function r(t,e,n){return this instanceof r?(o.call(this),this.options=i.extend({serialization:"binary",reliable:!1},n),this.open=!1,this.type="data",this.peer=t,this.provider=e,this.id=this.options.connectionId||r._idPrefix+i.randomToken(),this.label=this.options.label||this.id,this.metadata=this.options.metadata,this.serialization=this.options.serialization,this.reliable=this.options.reliable,this._buffer=[],this._buffering=!1,this.bufferSize=0,this._chunkedData={},this.options._payload&&(this._peerBrowser=this.options._payload.browser),void u.startConnection(this,this.options._payload||{originator:!0})):new r(t,e,n)}var i=n(128),o=n(132),u=n(135),a=n(137);i.inherits(r,o),r._idPrefix="dc_",r.prototype.initialize=function(t){this._dc=this.dataChannel=t,this._configureDataChannel()},r.prototype._configureDataChannel=function(){var t=this;i.supports.sctp&&(this._dc.binaryType="arraybuffer"),this._dc.onopen=function(){i.log("Data channel connection success"),t.open=!0,t.emit("open")},!i.supports.sctp&&this.reliable&&(this._reliable=new a(this._dc,i.debug)),this._reliable?this._reliable.onmessage=function(e){t.emit("data",e)}:this._dc.onmessage=function(e){t._handleDataMessage(e)},this._dc.onclose=function(e){i.log("DataChannel closed for:",t.peer),t.close()}},r.prototype._handleDataMessage=function(t){var e=this,n=t.data,r=n.constructor;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(r===Blob)return void i.blobToArrayBuffer(n,function(t){n=i.unpack(t),e.emit("data",n)});if(r===ArrayBuffer)n=i.unpack(n);else if(r===String){var o=i.binaryStringToArrayBuffer(n);n=i.unpack(o)}}else"json"===this.serialization&&(n=JSON.parse(n));if(n.__peerData){var u=n.__peerData,a=this._chunkedData[u]||{data:[],count:0,total:n.total};return a.data[n.n]=n.data,a.count+=1,a.total===a.count&&(delete this._chunkedData[u],n=new Blob(a.data),this._handleDataMessage({data:n})),void(this._chunkedData[u]=a)}this.emit("data",n)},r.prototype.close=function(){this.open&&(this.open=!1,u.cleanup(this),this.emit("close"))},r.prototype.send=function(t,e){if(!this.open)return void this.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages."));if(this._reliable)return void this._reliable.send(t);var n=this;if("json"===this.serialization)this._bufferedSend(JSON.stringify(t));else if("binary"===this.serialization||"binary-utf8"===this.serialization){var r=i.pack(t),o=i.chunkedBrowsers[this._peerBrowser]||i.chunkedBrowsers[i.browser];if(o&&!e&&r.size>i.chunkedMTU)return void this._sendChunks(r);i.supports.sctp?i.supports.binaryBlob?this._bufferedSend(r):i.blobToArrayBuffer(r,function(t){n._bufferedSend(t)}):i.blobToBinaryString(r,function(t){n._bufferedSend(t)})}else this._bufferedSend(t)},r.prototype._bufferedSend=function(t){!this._buffering&&this._trySend(t)||(this._buffer.push(t),this.bufferSize=this._buffer.length)},r.prototype._trySend=function(t){try{this._dc.send(t)}catch(t){this._buffering=!0;var e=this;return setTimeout(function(){e._buffering=!1,e._tryBuffer()},100),!1}return!0},r.prototype._tryBuffer=function(){if(0!==this._buffer.length){var t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this.bufferSize=this._buffer.length,this._tryBuffer())}},r.prototype._sendChunks=function(t){for(var e=i.chunk(t),n=0,r=e.length;n<r;n+=1){var t=e[n];this.send(t,!0)}},r.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case"ANSWER":this._peerBrowser=e.browser,u.handleSDP(t.type,this,e.sdp);break;case"CANDIDATE":u.handleCandidate(this,e.candidate);break;default:i.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},t.exports=r},function(t,e,n){function r(t,e){return this instanceof r?(this._dc=t,i.debug=e,this._outgoing={},this._incoming={},this._received={},this._window=1e3,this._mtu=500,this._interval=0,this._count=0,this._queue=[],void this._setupDC()):new r(t)}var i=n(138);r.prototype.send=function(t){var e=i.pack(t);return e.size<this._mtu?void this._handleSend(["no",e]):(this._outgoing[this._count]={ack:0,chunks:this._chunk(e)},i.debug&&(this._outgoing[this._count].timer=new Date),this._sendWindowedChunks(this._count),void(this._count+=1))},r.prototype._setupInterval=function(){var t=this;this._timeout=setInterval(function(){var e=t._queue.shift();if(e._multiple)for(var n=0,r=e.length;n<r;n+=1)t._intervalSend(e[n]);else t._intervalSend(e)},this._interval)},r.prototype._intervalSend=function(t){var e=this;t=i.pack(t),i.blobToBinaryString(t,function(t){e._dc.send(t)}),0===e._queue.length&&(clearTimeout(e._timeout),e._timeout=null)},r.prototype._processAcks=function(){for(var t in this._outgoing)this._outgoing.hasOwnProperty(t)&&this._sendWindowedChunks(t)},r.prototype._handleSend=function(t){for(var e=!0,n=0,r=this._queue.length;n<r;n+=1){var i=this._queue[n];i===t?e=!1:i._multiple&&i.indexOf(t)!==-1&&(e=!1)}e&&(this._queue.push(t),this._timeout||this._setupInterval())},r.prototype._setupDC=function(){var t=this;this._dc.onmessage=function(e){var n=e.data,r=n.constructor;if(r===String){var o=i.binaryStringToArrayBuffer(n);n=i.unpack(o),t._handleMessage(n)}}},r.prototype._handleMessage=function(t){var e,n=t[1],r=this._incoming[n],o=this._outgoing[n];switch(t[0]){case"no":var u=n;u&&this.onmessage(i.unpack(u));break;case"end":if(e=r,this._received[n]=t[2],!e)break;this._ack(n);break;case"ack":if(e=o){var a=t[2];e.ack=Math.max(a,e.ack),e.ack>=e.chunks.length?(i.log("Time: ",new Date-e.timer),delete this._outgoing[n]):this._processAcks()}break;case"chunk":if(e=r,!e){var s=this._received[n];if(s===!0)break;e={ack:["ack",n,0],chunks:[]},this._incoming[n]=e}var c=t[2],f=t[3];e.chunks[c]=new Uint8Array(f),c===e.ack[2]&&this._calculateNextAck(n),this._ack(n);break;default:this._handleSend(t)}},r.prototype._chunk=function(t){for(var e=[],n=t.size,r=0;r<n;){var o=Math.min(n,r+this._mtu),u=t.slice(r,o),a={payload:u};e.push(a),r=o}return i.log("Created",e.length,"chunks."),e},r.prototype._ack=function(t){var e=this._incoming[t].ack;this._received[t]===e[2]&&(this._complete(t),this._received[t]=!0),this._handleSend(e)},r.prototype._calculateNextAck=function(t){for(var e=this._incoming[t],n=e.chunks,r=0,i=n.length;r<i;r+=1)if(void 0===n[r])return void(e.ack[2]=r);e.ack[2]=n.length},r.prototype._sendWindowedChunks=function(t){i.log("sendWindowedChunks for: ",t);for(var e=this._outgoing[t],n=e.chunks,r=[],o=Math.min(e.ack+this._window,n.length),u=e.ack;u<o;u+=1)n[u].sent&&u!==e.ack||(n[u].sent=!0,r.push(["chunk",t,u,n[u].payload]));e.ack+this._window>=n.length&&r.push(["end",t,n.length]),r._multiple=!0,this._handleSend(r)},r.prototype._complete=function(t){i.log("Completed called for",t);var e=this,n=this._incoming[t].chunks,r=new Blob(n);i.blobToArrayBuffer(r,function(t){e.onmessage(i.unpack(t))}),delete this._incoming[t]},r.higherBandwidthSDP=function(t){var e=navigator.appVersion.match(/Chrome\/(.*?) /);if(e&&(e=parseInt(e[1].split(".").shift()),e<31)){var n=t.split("b=AS:30"),r="b=AS:102400";if(n.length>1)return n[0]+r+n[1]}return t},r.prototype.onmessage=function(t){},t.exports.Reliable=r},function(t,e,n){var r=n(129),i={debug:!1,inherits:function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},extend:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},pack:r.pack,unpack:r.unpack,log:function(){if(i.debug){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.unshift("Reliable: "),console.log.apply(console,t)}},setZeroTimeout:function(t){function e(e){r.push(e),t.postMessage(i,"*")}function n(e){e.source==t&&e.data==i&&(e.stopPropagation&&e.stopPropagation(),r.length&&r.shift()())}var r=[],i="zero-timeout-message";return t.addEventListener?t.addEventListener("message",n,!0):t.attachEvent&&t.attachEvent("onmessage",n),e}(this),blobToArrayBuffer:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsArrayBuffer(t)},blobToBinaryString:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsBinaryString(t)},binaryStringToArrayBuffer:function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer},randomToken:function(){return Math.random().toString(36).substr(2)}};t.exports=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(57),o=r(i),u=function t(){(0,o.default)(this,t)};e.default=u},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(74),u=i(o),a=n(57),s=i(a),c=n(58),f=i(c),l=n(78),h=i(l),p=n(99),d=i(p),v=n(71),y=i(v),_=n(127),g=i(_),m=n(139),b=i(m),w=n(116),k=r(w),x=n(115),S=i(x),M=n(73),E=i(M),A={init:function(t){var e=S.default.parse(t.state);E.default.nextDiscId=y.default.max(e.discs,function(t){return t.id}).id+1,this.game.simulator.resetState(e);var n=this.game.simulator.advance(),r=n.getPlayerById(t.id),i=n.getPlayerDisc(r);i&&(i.isMe=!0),this.game.myId=r.clientId,this.game.init(),this.game.initRenderer()},sync:function(t){var e=this.game.simulator.currentFrame;if(t.state.frame<=this.lastSyncFrame)return void console.log("frame earlier than last sync");if(t.state.frame<e&&this.game.simulator.oldestFrame>t.state.frame+1)return void console.log("sync frame too far behind",e,t.state.frame);var n=(this.game.simulator.findStateFromFrame(t.state.frame),S.default.parse(t.state));this.game.simulator.resetState(n),this.lastSyncFrame=t.state.frame,e>t.state.frame&&this.game.simulator.fastForward(e)},event:function t(e){var t=k[e.event.eventType].parse(e.event.sender,e.event.data);if(t.frame=e.event.frame,t.frame>=this.game.simulator.currentFrame)this.game.simulator.addEvent(t,t.frame);else if(this.game.simulator.hasFrameInHistory(t.frame)){var n=this.game.simulator.currentFrame;this.game.simulator.rewind(t.frame),this.game.simulator.addEvent(t),this.game.simulator.fastForward(n)}}},O=function(t){function e(t){(0,s.default)(this,e);var n=(0,h.default)(this,(e.__proto__||(0,u.default)(e)).call(this));n.nick="sock",n.lastSyncFrame=0,n.game=t,t.network=n;var r=Math.random().toString(36).substring(7);return n.peer=new g.default(r,{host:"localhost",path:"/p2p"}),n}return(0,d.default)(e,t),(0,f.default)(e,[{key:"connectTo",value:function(t){var e=this;this.hostConn=this.peer.connect(t),this.hostConn.on("data",this.handleMsg.bind(this)),this.hostConn.on("close",function(){e.game.destroy()})}},{key:"handleMsg",value:function(t){if(!A[t.type]||"function"!=typeof A[t.type])throw new Error("Invalid msg type recieved: "+t.type);A[t.type].call(this,t)}},{key:"sendMsg",value:function(t){this.hostConn.send(t)}}]),e}(b.default);e.default=O}])});